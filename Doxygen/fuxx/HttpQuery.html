<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


<link rel="shortcut icon" type="image/x-icon" href="http://www.arangodb.org/wp-content/themes/triagens/images/favicon.ico">

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.arangodb.org/wp-content/themes/triagens-child/style.css" />
<link rel="pingback" href="" />


<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.4 - http://yoast.com/wordpress/seo/ -->
<title>ArangoDB Manual Pages - ArangoDB</title>
<meta name="description" content="ArangoDB Manual Pages"/>
<link rel="canonical" href="http://www.arangodb.org/manualredirector" />
<meta property='og:locale' content='en_US'/>
<meta property='og:title' content='ArangoDB Manual Pages - ArangoDB'/>
<meta property='og:description' content='ArangoDB Manual Pages'/>
<meta property='og:url' content='http://www.arangodb.org/manualredirector'/>
<meta property='og:site_name' content='ArangoDB'/>
<meta property='og:type' content='article'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Feed" href="http://www.arangodb.org/feed" />
<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Comments Feed" href="http://www.arangodb.org/comments/feed" />
<link rel='stylesheet' id='wordpress-popular-posts-css'  href='http://www.arangodb.org/wp-content/plugins/wordpress-popular-posts/style/wpp.css?ver=3.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.arangodb.org/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>

    <style type="text/css">
    body {
    margin-top: -28px;
    padding-bottom: 28px;
    }
    body.admin-bar #wphead {
       padding-top: 0;
    }
    body.admin-bar #footer {
       padding-bottom: 28px;
    }
<link type="text/css" media="screen" rel="stylesheet" href="http://www.arangodb.org/wp-content/plugins/tweet-blender/css/tweets.css" />

    <style media="print" type="text/css">
      div.faq_answer {display: block!important;}
      p.faq_nav {display: none;}
    </style>


</head>

<body class="page page-id-1410 page-template page-template-onecolumn-page-php">

    <div id="access" role="navigation">
        <div id="nav">
            <a href="http://www.arangodb.org/" title="ArangoDB" id="branding"><img src="/wp-content/themes/triagens/images/logo_arangob_white.gif" width="154" height="34" alt="ArangoDB"></a>
            <div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-184" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-184"><a href="http://www.arangodb.org/">Home</a></li>
<li id="menu-item-1345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1345"><a href="http://www.arangodb.org/try">Try it out</a></li>
<li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://www.arangodb.org/documentation">Documentation</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-95"><a href="http://www.arangodb.org/roadmap">Roadmap</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="http://www.arangodb.org/download">Downloads</a></li>
<li id="menu-item-1299" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1299"><a href="http://www.arangodb.org/api">Drivers</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://www.arangodb.org/blog">Blog</a></li>
</ul></div>            <div class="clear_both"></div>
        </div>
    </div><!-- #access -->

  <div id="surrounding">

    <div id="wrapper" class="hfeed">
	<div id="main">

    <div id="fullsize" class="one-column">
      <div id="content" role="main">



            <div id="post-1410" class="post-1410 page type-page status-publish hentry">
                    <h2 class="entry-title">ArangoDB Manual Pages</h2>

	  <div class="entry-content">

<link id="arangodb.css" type="text/css" href="arangodb.css" rel="stylesheet">
</div>
<div id="manual_search">
<form action="/" id="searchform" method="get" role="search">
  <div><label for="s" class="screen-reader-text">Search for:</label>
    <input type="text" id="s" name="s" value="" />
    <input type="submit" value="Search" id="searchsubmit" />
  </div>
</form>
</div>
<div class="clear_both"></div>
<hr />
<div class="arangodb">
<div>
<!-- Generated by Doxygen 1.8.2 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HTTP Interface for AQL Queries </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> <div class="navigate"><a href="HttpCursor.html">prev</a> | <a href="ImplementorManual.html">home</a> | <a href="HttpCurrentDatabase.html">next</a></div>  <div class="toc"><ul>
<li><a class="el" href="HttpQuery.html">HTTP Interface for AQL Queries</a><ul>
<li><a class="el" href="HttpQuery.html#HttpExplainPost">POST /_api/explain</a></li>
<li><a class="el" href="HttpQuery.html#HttpQueryPost">POST /_api/query</a> </li>
</ul>
</li>
</ul>
  </div> ArangoDB has an Http interface to syntactically validate AQL queries. Furthermore, it offers an Http interface to retrieve the execution plan for any valid AQL query.</p>
<p>Both functionalities do not actually execute the supplied AQL query, but only inspect it and return meta information about it.</p>
<p><a class="anchor" id="HttpExplainPost"></a> </p><div class="restheader">POST /_api/explain<div class="restheaderremark">(explains a query)</div></div> <H3>Body parameters</H3><div class="restbodyparam">body (json,required)</div> The query string needs to be passed in the attribute <code>query</code> of a JSON object as the body of the POST request. If the query references any bind variables, these must also be passed in the attribute <code>bindVars</code>. <H3 class="space-before">Description</H3>To explain how an AQL query would be executed on the server, the query string can be sent to the server via an HTTP POST request. The server will then validate the query and create an execution plan for it, but will not execute it.The execution plan that is returned by the server can be used to estimate the probable performance of an AQL query. Though the actual performance will depend on many different factors, the execution plan normally can give some good hint on the amount of work the server needs to do in order to actually run the query.The top-level statements will appear in the result in the same order in which they have been used in the original query. Each result element has at most the following attributes:</p>
<ul>
<li><code>id</code>: the row number of the top-level statement, starting at 1</li>
<li><code>type</code>: the type of the top-level statement (e.g. <code>for</code>, <code>return</code> ...)</li>
<li><code>loopLevel</code>: the nesting level of the top-level statement, starting at 1 Depending on the type of top-level statement, there might be other attributes providing additional information, for example, if and which indexed will be used. Many top-level statements will provide an <code>expression</code> attribute that contains data about the expression they operate on. This is true for <code>FOR</code>, <code>FILTER</code>, <code>SORT</code>, <code>COLLECT</code>, and <code>RETURN</code> statements. The <code>expression</code> attribute has the following sub-attributes:</li>
<li><code>type</code>: the type of the expression. Some possible values are:<ul>
<li><code>collection</code>: an iteration over documents from a collection. The <code>value</code> attribute will then contain the collection name. The <code>extra</code> attribute will contain information about if and which index is used when accessing the documents from the collection. If no index is used, the <code>accessType</code> sub-attribute of the <code>extra</code> attribute will have the value <code>all</code>, otherwise it will be <code>index</code>.</li>
<li><code>list</code>: a list of dynamic values. The <code>value</code> attribute will contain the list elements.</li>
<li><code>const list</code>: a list of constant values. The <code>value</code> attribute will contain the list elements.</li>
<li><code>reference</code>: a reference to another variable. The <code>value</code> attribute will contain the name of the variable that is referenced.</li>
</ul>
</li>
</ul>
Please note that the structure of the explain result data might change in future versions of ArangoDB without further notice and without maintaining backwards compatibility. <H3>Return codes</H3> <p></p><div class="restreturncode">HTTP 200</div> If the query is valid, the server will respond with <code>HTTP 200</code> and return a list of the individual query execution steps in the <code>"plan"</code> attribute of the response. <p></p><div class="restreturncode">HTTP 400</div> The server will respond with <code>HTTP 400</code> in case of a malformed request, or if the query contains a parse error. The body of the response will contain the error details embedded in a JSON object. Omitting bind variables if the query references any will result also result in an <code>HTTP 400</code> error. <p></p><div class="restreturncode">HTTP 404</div> The server will respond with <code>HTTP 404</code> in case a non-existing collection is accessed in the query. <H3>Examples</H3>Valid query:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/explain
{ "query" : "FOR p IN products FILTER p.id == @id LIMIT 2 RETURN p.name", "bindVars": { "id" : 3 } }

HTTP/1.1 200 OK
content-type: application/json; charset=utf-8

{ 
  "plan" : [ 
    { 
      "id" : 1, 
      "loopLevel" : 1, 
      "type" : "for", 
      "resultVariable" : "p", 
      "limit" : true, 
      "expression" : { 
        "type" : "collection", 
        "value" : "products", 
        "extra" : { 
          "accessType" : "all" 
        } 
      } 
    }, 
    { 
      "id" : 2, 
      "loopLevel" : 1, 
      "type" : "filter", 
      "expression" : { 
        "type" : "expression", 
        "value" : "p.id == 3" 
      } 
    }, 
    { 
      "id" : 3, 
      "loopLevel" : 1, 
      "type" : "return", 
      "expression" : { 
        "type" : "expression", 
        "value" : "p.name" 
      } 
    } 
  ], 
  "error" : false, 
  "code" : 200 
}

</pre><p> Invalid query:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/explain
{ "query" : "FOR p IN products FILTER p.id == @id LIMIT 2 RETURN p.n" }

HTTP/1.1 400 Bad Request
content-type: application/json; charset=utf-8

{ 
  "error" : true, 
  "code" : 400, 
  "errorNum" : 1551, 
  "errorMessage" : "no value specified for declared bind parameter 'id'" 
}

</pre><p> The data returned in the <code>plan</code> attribute of the result contains one element per AQL top-level statement (i.e. <code>FOR</code>, <code>RETURN</code>, <code>FILTER</code> etc.). If the query optimiser removed some unnecessary statements, the result might also contain less elements than there were top-level statements in the AQL query. The following example shows a query with a non-sensible filter condition that the optimiser has removed so that there are less top-level statements:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/explain
{ "query" : "FOR i IN [ 1, 2, 3 ] FILTER 1 == 2 RETURN i" }

HTTP/1.1 200 OK
content-type: application/json; charset=utf-8

{ 
  "plan" : [ 
    { 
      "id" : 1, 
      "loopLevel" : 0, 
      "type" : "return (empty)", 
      "expression" : { 
        "type" : "const list", 
        "value" : "[  ]" 
      } 
    } 
  ], 
  "error" : false, 
  "code" : 200 
}

</pre> </p>
<p><a class="anchor" id="HttpQueryPost"></a> </p><div class="restheader">POST /_api/query<div class="restheaderremark">(parses a query)</div></div> <H3>Body parameters</H3><div class="restbodyparam">query (json,required)</div> <H3 class="space-before">Description</H3>To validate a query string without executing it, the query string can be passed to the server via an HTTP POST request.These query string needs to be passed in the attribute <code>query</code> of a JSON object as the body of the POST request. <H3>Return codes</H3> <p></p><div class="restreturncode">HTTP 200</div> If the query is valid, the server will respond with <code>HTTP 200</code> and return the names of the bind parameters it found in the query (if any) in the <code>"bindVars"</code> attribute of the response. <p></p><div class="restreturncode">HTTP 400</div> The server will respond with <code>HTTP 400</code> in case of a malformed request, or if the query contains a parse error. The body of the response will contain the error details embedded in a JSON object. <H3>Examples</H3>Valid query:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/query
{ "query" : "FOR p IN products FILTER p.name == @name LIMIT 2 RETURN p.n" }

HTTP/1.1 200 OK
content-type: application/json; charset=utf-8

{ 
  "bindVars" : [ 
    "name" 
  ], 
  "collections" : [ 
    "products" 
  ], 
  "error" : false, 
  "code" : 200 
}

</pre><p> Invalid query:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/query
{ "query" : "FOR p IN products FILTER p.name = @name LIMIT 2 RETURN p.n" }

HTTP/1.1 400 Bad Request
content-type: application/json; charset=utf-8

{ 
  "error" : true, 
  "code" : 400, 
  "errorNum" : 1501, 
  "errorMessage" : "1:33 syntax error, unexpected assignment near '= @name LIMIT 2 RETURN p.n'" 
}

</pre>  </p>
</div></div><!-- contents -->
</div>


	  </div><!-- .entry-content -->
	</div><!-- #post-## -->


      <div id="comments">


  <p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


      </div><!-- #content -->
    </div><!-- #container -->

  <div style="clear:both;"></div>
  </div><!-- #main -->



</div><!-- #wrapper -->
</div><!-- #surrounding -->


  <div id="footer" role="contentinfo">
    <div id="colophon">




      <div id="footer-widget-area" role="complementary">

	<div id="first" class="widget-area">
	  <ul class="xoxo">
		<li id="recent-posts-4" class="widget-container widget_recent_entries">	  <h3 class="widget-title">Recent Posts</h3>	<ul>
	  <li>
	<a href="http://www.arangodb.org/2013/05/22/replication-and-sharding-in-arangodb" title="Our plans on replication and sharding in ArangoDB">Our plans on replication and sharding in ArangoDB</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/14/ideas-and-facts-from-scotland-js-in-edinburgh" title="Ideas and Facts from scotland.js in Edinburgh">Ideas and Facts from scotland.js in Edinburgh</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/12/arangodb-1-3-0-released" title="ArangoDB 1.3.0 released">ArangoDB 1.3.0 released</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/06/foxx-screencast-part-2" title="Foxx Screencast: Part 2">Foxx Screencast: Part 2</a>
	    </li>
	</ul>
    </li><li id="text-5" class="widget-container widget_text"><h3 class="widget-title">Documentation</h3>     <div class="textwidget"><ul>
  <li><a href="/quickstart">First step tutorial</a></li>
  <li><a href="/manuals">Manual/documentation (HTML/PDF)</a></li>
  <li><a href="/manuals/arangodb_1.0_shell_reference_card.pdf">ArangoDB Shell Reference Card (HTML/PDF)</a></li>
  <li><a href="/try">Try ArangoDB online</a></li>
  <li><a href="/api">API clients & 3rd party libs</a></li>
        <li><a href="/logos">ArangoDB artwork/logos</a></li>
</ul>
</div>
    </li><li id="text-7" class="widget-container widget_text"><h3 class="widget-title">Social Links</h3>      <div class="textwidget"><ul>
  <li><a href="https://twitter.com/arangodb">ArangoDB on Twitter</a></li>
  <li><a href="https://groups.google.com/group/arangodb">ArangoDB Google Group</a></li>
  <li><a href="http://stackoverflow.com/questions/tagged/arangodb">ArangoDB questions on StackOverflow</a></li>
  <li><a href="https://github.com/triagens/arangodb/issues?state=open">Issue Tracker at Github</a></li>
</ul></div>
    </li><li id="text-6" class="widget-container widget_text"><h3 class="widget-title">Roadmap</h3>	<div class="textwidget"><ul>
  <li><a href="/roadmap/#v1.4">Backlog for Version 1.4</a></li>
  <li><a href="/roadmap/#v1.x">Backlog for Version 1.x</a></li>
</ul></div>
    </li>	  </ul>
	</div><!-- #first .widget-area -->




      </div><!-- #footer-widget-area -->


<!-- #site-generator -->

    </div><!-- #colophon -->

        <div class="copy">
            Copyright 2013 ArangoDB | <a href="/imprint">Imprint</a>
        </div>

  </div><!-- #footer -->

</body>
</html>