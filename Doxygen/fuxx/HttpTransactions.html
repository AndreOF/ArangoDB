<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


<link rel="shortcut icon" type="image/x-icon" href="http://www.arangodb.org/wp-content/themes/triagens/images/favicon.ico">

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.arangodb.org/wp-content/themes/triagens-child/style.css" />
<link rel="pingback" href="" />


<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.4 - http://yoast.com/wordpress/seo/ -->
<title>ArangoDB Manual Pages - ArangoDB</title>
<meta name="description" content="ArangoDB Manual Pages"/>
<link rel="canonical" href="http://www.arangodb.org/manualredirector" />
<meta property='og:locale' content='en_US'/>
<meta property='og:title' content='ArangoDB Manual Pages - ArangoDB'/>
<meta property='og:description' content='ArangoDB Manual Pages'/>
<meta property='og:url' content='http://www.arangodb.org/manualredirector'/>
<meta property='og:site_name' content='ArangoDB'/>
<meta property='og:type' content='article'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Feed" href="http://www.arangodb.org/feed" />
<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Comments Feed" href="http://www.arangodb.org/comments/feed" />
<link rel='stylesheet' id='wordpress-popular-posts-css'  href='http://www.arangodb.org/wp-content/plugins/wordpress-popular-posts/style/wpp.css?ver=3.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.arangodb.org/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>

    <style type="text/css">
    body {
    margin-top: -28px;
    padding-bottom: 28px;
    }
    body.admin-bar #wphead {
       padding-top: 0;
    }
    body.admin-bar #footer {
       padding-bottom: 28px;
    }
<link type="text/css" media="screen" rel="stylesheet" href="http://www.arangodb.org/wp-content/plugins/tweet-blender/css/tweets.css" />

    <style media="print" type="text/css">
      div.faq_answer {display: block!important;}
      p.faq_nav {display: none;}
    </style>


</head>

<body class="page page-id-1410 page-template page-template-onecolumn-page-php">

    <div id="access" role="navigation">
        <div id="nav">
            <a href="http://www.arangodb.org/" title="ArangoDB" id="branding"><img src="/wp-content/themes/triagens/images/logo_arangob_white.gif" width="154" height="34" alt="ArangoDB"></a>
            <div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-184" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-184"><a href="http://www.arangodb.org/">Home</a></li>
<li id="menu-item-1345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1345"><a href="http://www.arangodb.org/try">Try it out</a></li>
<li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://www.arangodb.org/documentation">Documentation</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-95"><a href="http://www.arangodb.org/roadmap">Roadmap</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="http://www.arangodb.org/download">Downloads</a></li>
<li id="menu-item-1299" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1299"><a href="http://www.arangodb.org/api">Drivers</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://www.arangodb.org/blog">Blog</a></li>
</ul></div>            <div class="clear_both"></div>
        </div>
    </div><!-- #access -->

  <div id="surrounding">

    <div id="wrapper" class="hfeed">
	<div id="main">

    <div id="fullsize" class="one-column">
      <div id="content" role="main">



            <div id="post-1410" class="post-1410 page type-page status-publish hentry">
                    <h2 class="entry-title">ArangoDB Manual Pages</h2>

	  <div class="entry-content">

<link id="arangodb.css" type="text/css" href="arangodb.css" rel="stylesheet">
</div>
<div id="manual_search">
<form action="/" id="searchform" method="get" role="search">
  <div><label for="s" class="screen-reader-text">Search for:</label>
    <input type="text" id="s" name="s" value="" />
    <input type="submit" value="Search" id="searchsubmit" />
  </div>
</form>
</div>
<div class="clear_both"></div>
<hr />
<div class="arangodb">
<div>
<!-- Generated by Doxygen 1.8.2 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">HTTP Interface for Transactions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> <div class="navigate"><a href="IndexFulltextHttp.html">prev</a> | <a href="ImplementorManual.html">home</a> | <a href="HttpGraph.html">next</a></div>  <div class="toc"><ul>
<li><a class="el" href="HttpTransactions.html">HTTP Interface for Transactions</a><ul>
<li><a class="el" href="HttpTransactions.html#HttpTransactionsIntro">Transactions </a></li>
<li><a class="el" href="HttpTransactions.html#HttpTransactionsHttp">Executing Transactions via HTTP </a><ul>
<li><a class="el" href="HttpTransactions.html#HttpTransactionsPost">POST /_api/transactions</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
  </div> <h2><a class="anchor" id="HttpTransactionsIntro"></a>
Transactions </h2>
<p>ArangoDB's transactions are executed on the server. Transactions can be initiated by clients by sending the transaction description for execution to the server.</p>
<p>Transactions in ArangoDB do not offer seperate <code>BEGIN</code>, <code>COMMIT</code> and <code>ROLLBACK</code> operations as they are available in many other database products. Instead, ArangoDB transactions are described by a Javascript function, and the code inside the Javascript function will then be executed transactionally. At the end of the function, the transaction is automatically committed, and all changes done by the transaction will be persisted. If an exception is thrown during transaction execution, all operations performed in the transaction are rolled back.</p>
<p>For a more detailed description of how transactions work in ArangoDB please refer to <a class="el" href="Transactions.html">Transactions</a>.</p>
<h2><a class="anchor" id="HttpTransactionsHttp"></a>
Executing Transactions via HTTP </h2>
<p><a class="anchor" id="HttpTransactionsPost"></a> </p><div class="restheader">POST /_api/transaction<div class="restheaderremark">(executes a transaction)</div></div> <H3>Body parameters</H3><div class="restbodyparam">body (string,required)</div> Contains the <code>collections</code> and <code>action</code>. <H3 class="space-before">Description</H3>The transaction description must be passed in the body of the POST request.The following attributes must be specified inside the JSON object:<ul>
<li><code>collections</code>: contains the list of collections to be used in the transaction (mandatory). <code>collections</code> must be a JSON array that can have the optional sub-attributes <code>read</code> and <code>write</code>. <code>read</code> and <code>write</code> must each be either lists of collections names or strings with a single collection name.</li>
</ul>
<ul>
<li><code>action</code>: the actual transaction operations to be executed, in the form of stringified Javascript code. The code will be executed on server side, with late binding. It is thus critical that the code specified in <code>action</code> properly sets up all the variables it needs. If the code specified in <code>action</code> ends with a return statement, the value returned will also be returned by the REST API in the <code>result</code> attribute if the transaction committed successfully.</li>
</ul>
The following optional attributes may also be specified in the request:<ul>
<li><code>waitForSync</code>: an optional boolean flag that, if set, will force the transaction to write all data to disk before returning.</li>
</ul>
<ul>
<li><code>lockTimeout</code>: an optional numeric value that can be used to set a timeout for waiting on collection locks. If not specified, a default value will be used. Setting <code>lockTimeout</code> to <code>0</code> will make ArangoDB not time out waiting for a lock.</li>
</ul>
<ul>
<li><code>params</code>: optional arguments passed to <code>action</code>.</li>
</ul>
If the transaction is fully executed and committed on the server, <code>HTTP 200</code> will be returned. Additionally, the return value of the code defined in <code>action</code> will be returned in the <code>result</code> attribute.For successfully committed transactions, the returned JSON object has the following properties:<ul>
<li><code>error</code>: boolean flag to indicate if an error occurred (<code>false</code> in this case)</li>
</ul>
<ul>
<li><code>code</code>: the HTTP status code</li>
</ul>
<ul>
<li><code>result</code>: the return value of the transaction</li>
</ul>
If the transaction specification is either missing or malformed, the server will respond with <code>HTTP 400</code>.The body of the response will then contain a JSON object with additional error details. The object has the following attributes:<ul>
<li><code>error</code>: boolean flag to indicate that an error occurred (<code>true</code> in this case)</li>
</ul>
<ul>
<li><code>code</code>: the HTTP status code</li>
</ul>
<ul>
<li><code>errorNum</code>: the server error number</li>
</ul>
<ul>
<li><code>errorMessage</code>: a descriptive error message</li>
</ul>
If a transaction fails to commit, either by an exception thrown in the <code>action</code> code, or by an internal error, the server will respond with an error. Any other errors will be returned with any of the return codes <code>HTTP 400</code>, <code>HTTP 409</code>, or <code>HTTP 500</code>. <H3>Return codes</H3> <p></p><div class="restreturncode">HTTP 200</div> If the transaction is fully executed and committed on the server, <code>HTTP 200</code> will be returned. <p></p><div class="restreturncode">HTTP 400</div> If the transaction specification is either missing or malformed, the server will respond with <code>HTTP 400</code>. <p></p><div class="restreturncode">HTTP 500</div> Exceptions thrown by users will make the server respond with a return code of <code>HTTP 500</code> <H3>Examples</H3>Executing a transaction on a single collection:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/transaction
{ "collections": { "write" : "products" }, "action" : "function () { var db = require(\"internal\").db;db.products.save({});return db.products.count(); }" }

HTTP/1.1 200 OK
content-type: application/json; charset=utf-8

{ 
  "result" : 1, 
  "error" : false, 
  "code" : 200 
}

</pre><p> Executing a transaction using multiple collections:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/transaction
{ "collections": { "write" : ["products", "materials" ] }, "action" : "function () { var db = require(\"internal\").db;db.products.save({});db.materials.save({});return \"worked!\"; }" }

HTTP/1.1 200 OK
content-type: application/json; charset=utf-8

{ 
  "result" : "worked!", 
  "error" : false, 
  "code" : 200 
}

</pre><p> Aborting a transaction due to an internal error:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/transaction
{ "collections": { "write" : "products" }, "action" : "function () { var db = require(\"internal\").db;db.products.save({_key: \"abc\"});db.products.save({_key: \"abc\"});

HTTP/1.1 400 Bad Request
content-type: application/json; charset=utf-8

{ 
  "error" : true, 
  "code" : 400, 
  "errorNum" : 400, 
  "errorMessage" : "bad parameter" 
}

</pre><p> Aborting a transaction by throwing an exception:<pre class="fragment">unix&gt; curl -X POST --data @- --dump - http://localhost:8529/_api/transaction
{ "collections": { "read" : "products" }, "action" : "function () { throw \"doh!\"; }" }

HTTP/1.1 500 Internal Error
content-type: application/json; charset=utf-8

{ 
  "error" : true, 
  "code" : 500, 
  "errorNum" : 500, 
  "errorMessage" : "doh!" 
}

</pre>  </p>
</div></div><!-- contents -->
</div>


	  </div><!-- .entry-content -->
	</div><!-- #post-## -->


      <div id="comments">


  <p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


      </div><!-- #content -->
    </div><!-- #container -->

  <div style="clear:both;"></div>
  </div><!-- #main -->



</div><!-- #wrapper -->
</div><!-- #surrounding -->


  <div id="footer" role="contentinfo">
    <div id="colophon">




      <div id="footer-widget-area" role="complementary">

	<div id="first" class="widget-area">
	  <ul class="xoxo">
		<li id="recent-posts-4" class="widget-container widget_recent_entries">	  <h3 class="widget-title">Recent Posts</h3>	<ul>
	  <li>
	<a href="http://www.arangodb.org/2013/05/22/replication-and-sharding-in-arangodb" title="Our plans on replication and sharding in ArangoDB">Our plans on replication and sharding in ArangoDB</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/14/ideas-and-facts-from-scotland-js-in-edinburgh" title="Ideas and Facts from scotland.js in Edinburgh">Ideas and Facts from scotland.js in Edinburgh</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/12/arangodb-1-3-0-released" title="ArangoDB 1.3.0 released">ArangoDB 1.3.0 released</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/06/foxx-screencast-part-2" title="Foxx Screencast: Part 2">Foxx Screencast: Part 2</a>
	    </li>
	</ul>
    </li><li id="text-5" class="widget-container widget_text"><h3 class="widget-title">Documentation</h3>     <div class="textwidget"><ul>
  <li><a href="/quickstart">First step tutorial</a></li>
  <li><a href="/manuals">Manual/documentation (HTML/PDF)</a></li>
  <li><a href="/manuals/arangodb_1.0_shell_reference_card.pdf">ArangoDB Shell Reference Card (HTML/PDF)</a></li>
  <li><a href="/try">Try ArangoDB online</a></li>
  <li><a href="/api">API clients & 3rd party libs</a></li>
        <li><a href="/logos">ArangoDB artwork/logos</a></li>
</ul>
</div>
    </li><li id="text-7" class="widget-container widget_text"><h3 class="widget-title">Social Links</h3>      <div class="textwidget"><ul>
  <li><a href="https://twitter.com/arangodb">ArangoDB on Twitter</a></li>
  <li><a href="https://groups.google.com/group/arangodb">ArangoDB Google Group</a></li>
  <li><a href="http://stackoverflow.com/questions/tagged/arangodb">ArangoDB questions on StackOverflow</a></li>
  <li><a href="https://github.com/triagens/arangodb/issues?state=open">Issue Tracker at Github</a></li>
</ul></div>
    </li><li id="text-6" class="widget-container widget_text"><h3 class="widget-title">Roadmap</h3>	<div class="textwidget"><ul>
  <li><a href="/roadmap/#v1.4">Backlog for Version 1.4</a></li>
  <li><a href="/roadmap/#v1.x">Backlog for Version 1.x</a></li>
</ul></div>
    </li>	  </ul>
	</div><!-- #first .widget-area -->




      </div><!-- #footer-widget-area -->


<!-- #site-generator -->

    </div><!-- #colophon -->

        <div class="copy">
            Copyright 2013 ArangoDB | <a href="/imprint">Imprint</a>
        </div>

  </div><!-- #footer -->

</body>
</html>