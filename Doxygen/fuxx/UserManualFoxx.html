<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


<link rel="shortcut icon" type="image/x-icon" href="http://www.arangodb.org/wp-content/themes/triagens/images/favicon.ico">

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.arangodb.org/wp-content/themes/triagens-child/style.css" />
<link rel="pingback" href="" />


<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.4 - http://yoast.com/wordpress/seo/ -->
<title>ArangoDB Manual Pages - ArangoDB</title>
<meta name="description" content="ArangoDB Manual Pages"/>
<link rel="canonical" href="http://www.arangodb.org/manualredirector" />
<meta property='og:locale' content='en_US'/>
<meta property='og:title' content='ArangoDB Manual Pages - ArangoDB'/>
<meta property='og:description' content='ArangoDB Manual Pages'/>
<meta property='og:url' content='http://www.arangodb.org/manualredirector'/>
<meta property='og:site_name' content='ArangoDB'/>
<meta property='og:type' content='article'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Feed" href="http://www.arangodb.org/feed" />
<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Comments Feed" href="http://www.arangodb.org/comments/feed" />
<link rel='stylesheet' id='wordpress-popular-posts-css'  href='http://www.arangodb.org/wp-content/plugins/wordpress-popular-posts/style/wpp.css?ver=3.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.arangodb.org/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>

    <style type="text/css">
    body {
    margin-top: -28px;
    padding-bottom: 28px;
    }
    body.admin-bar #wphead {
       padding-top: 0;
    }
    body.admin-bar #footer {
       padding-bottom: 28px;
    }
<link type="text/css" media="screen" rel="stylesheet" href="http://www.arangodb.org/wp-content/plugins/tweet-blender/css/tweets.css" />

    <style media="print" type="text/css">
      div.faq_answer {display: block!important;}
      p.faq_nav {display: none;}
    </style>


</head>

<body class="page page-id-1410 page-template page-template-onecolumn-page-php">

    <div id="access" role="navigation">
        <div id="nav">
            <a href="http://www.arangodb.org/" title="ArangoDB" id="branding"><img src="/wp-content/themes/triagens/images/logo_arangob_white.gif" width="154" height="34" alt="ArangoDB"></a>
            <div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-184" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-184"><a href="http://www.arangodb.org/">Home</a></li>
<li id="menu-item-1345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1345"><a href="http://www.arangodb.org/try">Try it out</a></li>
<li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://www.arangodb.org/documentation">Documentation</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-95"><a href="http://www.arangodb.org/roadmap">Roadmap</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="http://www.arangodb.org/download">Downloads</a></li>
<li id="menu-item-1299" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1299"><a href="http://www.arangodb.org/api">Drivers</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://www.arangodb.org/blog">Blog</a></li>
</ul></div>            <div class="clear_both"></div>
        </div>
    </div><!-- #access -->

  <div id="surrounding">

    <div id="wrapper" class="hfeed">
	<div id="main">

    <div id="fullsize" class="one-column">
      <div id="content" role="main">



            <div id="post-1410" class="post-1410 page type-page status-publish hentry">
                    <h2 class="entry-title">ArangoDB Manual Pages</h2>

	  <div class="entry-content">

<link id="arangodb.css" type="text/css" href="arangodb.css" rel="stylesheet">
</div>
<div id="manual_search">
<form action="/" id="searchform" method="get" role="search">
  <div><label for="s" class="screen-reader-text">Search for:</label>
    <input type="text" id="s" name="s" value="" />
    <input type="submit" value="Search" id="searchsubmit" />
  </div>
</form>
</div>
<div class="clear_both"></div>
<hr />
<div class="arangodb">
<div>
<!-- Generated by Doxygen 1.8.2 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Foxx </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> <div class="navigate"><a href="UserManualActions.html">prev</a> | <a href="UserManual.html">home</a> | <a href="Transactions.html">next</a></div>  <div class="toc"><ul>
<li><a class="el" href="UserManualFoxx.html">Foxx</a> </li>
</ul>
  </div> <h2>Foxx: Build APIs and simple web applications in ArangoDB</h2>
<p>Foxx is an easy way to create APIs and simple web applications from within <b>ArangoDB</b>. It is inspired by Sinatra, the classy Ruby web framework. If FoxxApplication is Sinatra, <a href="http://www.arangodb.org/manuals/current/UserManualActions.html">ArangoDB Actions</a> are the corresponding <code>Rack</code>. They provide all the HTTP goodness.</p>
<p>So let's get started, shall we?</p>
<p>An application build with Foxx is written in JavaScript and deployed to ArangoDB directly. ArangoDB serves this application, you do not need a separate application server.</p>
<p>So given you want to build an application that sends a plain-text response "Worked!" for all requests to <code>/my/wiese</code>. How would you achieve that with Foxx?</p>
<p>First, create a directory <code>apps</code> somewhere in your filesystem. Let's assume from now on that the absolute path for this directory is <code>/home/user/apps</code>.</p>
<p>After that, create a sub-directory <code>my_app</code> in the <code>apps</code> directory and save the following content in a file named <code>app.js</code> there: </p>
<pre class="fragment">var Foxx = require("org/arangodb/foxx");

var app = new Foxx.Application();

app.get("/wiese", function(req, res) {
  res.set("Content-Type", "text/plain");
  res.body = "Worked!"
});

app.start(applicationContext);
</pre><p>Beside the app.js we need a manifest file. In order to achieve that, we create a file called <code>manifest.json</code> in our <code>my_app</code> directory with the following content:</p>
<p>{ "name": "my_app", "version": "0.0.1", "apps": { "/": "app.js" } }</p>
<p>You <b>must</b> specify a name and a version number for your application, otherwise it won't be loaded into ArangoDB.</p>
<p>You should now have the following files and directories with your application (starting at <code>/home/user</code> in our example): </p>
<pre class="fragment">apps/
     my_app/
            manifest.json
            app.js
</pre><p>This is your application. Now we need to mount it to the path <code>/my</code>.</p>
<p>Now your application is done. Start ArangoDB as follows: </p>
<pre class="fragment">$ arangod --javascript.dev-app-path /home/user/apps /tmp/fancy_db
</pre><p>Replace <code>/home/user/apps</code> with the apps path that you initially created. This is the path that you created the <code>my_app</code> directory in. Replace <code>/tmp/fancy_db</code> with the directory your database is located in.</p>
<p>To include your app in the list of apps running on your ArangoDB instance, start the ArangoDB shell and add your new application: </p>
<pre class="fragment">$ arangosh
arangosh&gt; aal = require('org/arangodb/aal');
arangosh&gt; aal.installDevApp('my_app', '/my');
</pre><p>Now point your browser to <code><a href="http://localhost:8529/my/wiese">http://localhost:8529/my/wiese</a></code> and you should see "Worked!". After this short overview, let's get into the details.</p>
<h3>Fishbowl - Foxx's app repository</h3>
<p>Foxx comes with a repository of apps other people created. This repository is called "fishbowl". You can access the repository through arangosh: </p>
<pre class="fragment">$ arangosh
arangosh&gt; aal = require('org/arangodb/aal');
arangosh&gt; aal.updateFishbowl();
    arangosh&gt; aal.listFishbowl();
</pre><p>This updates the list of available apps and displays the list. Let's assume you want to install the demo todo app called "aye_aye". First get a list of all available versions of "aye_aye": </p>
<pre class="fragment">    arangosh&gt; aal.details("aye_aye");
</pre><p>The following command can be copied from the results of the previous details command. To download version 1.0.8 of "aye_aye" from github repository run: </p>
<pre class="fragment">    arangosh&gt; aal.load("github", "mchacki/aye_aye", "v1.0.8");
</pre><p>The response contains the full path to the directory where "aye_aye" was saved. The last step is to mount "aye_aye" to a route of your choice, e.g. </p>
<pre class="fragment">    arangosh&gt; aal.installApp("aye_aye","/todos");
</pre><p>You can now use aye_aye in your browser at <code><a href="http://localhost:8529/todos">http://localhost:8529/todos</a></code>.</p>
<h3>Details on Foxx.Application</h3>
<h5>new Foxx.Application</h5>
<p>This creates a new Application. It takes two optional arguments as displayed above:</p>
<ul>
<li><b>The URL Prefix:</b> All routes you define within will be prefixed with it</li>
<li><b>The Template Collection:</b> More information in the template section</li>
</ul>
 <H3>Examples</H3><div class="fragment"><div class="line">app = <span class="keyword">new</span> Application({</div>
<div class="line">  urlPrefix: <span class="stringliteral">&quot;/wiese&quot;</span>,</div>
<div class="line">  templateCollection: <span class="stringliteral">&quot;my_templates&quot;</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::start</h5>
<p>Sometimes it is a good idea to actually start the application you wrote. If this precious moment has arrived, you should use this function. You have to provide the start function with the <code>applicationContext</code> variable. </p>
<h5>Foxx.Application::requires</h5>
<p>Using the base paths defined in the manifest file, you can require modules that you need in this FoxxApplication. So for example: </p>
<pre class="fragment">app.requires = {
  "sheepskin": "wolf"
};
</pre><p>This will require the file <code>wolf.js</code> in the libs folder you have defined and make the module available via the variable <code>sheepskin</code> in your FoxxApplication definitions: </p>
<pre class="fragment">app.get("/bark", function (req, res) {
  sheepskin.bark();
});
</pre><p><em>Please note that you cannot use the normal require syntax in a <code>FoxxApplication</code>, because it's a special DSL and not a normal JavaScript file.</em></p>
<h5>Foxx.Application::registerRepository</h5>
<p>A repository is a module that gets data from the database or saves data to it. A model is a representation of data which will be used by the repository. Use this method to register a repository and a corresponding model. They can then be used in your handlers via <code>repository.name</code> where name is the registered name. </p>
<pre class="fragment">Foxx = require("org/arangodb/foxx");

app = new Foxx.Application({});

app.registerRepository("todos", {
  model: "models/todos",
  repository: "repositories/todos"
});
</pre><p>If you do not give a repository, it will default to the <code>Foxx.Repository</code>. If you need more than the methods provided by it, you must give the path (relative to your lib directory) to your repository module there. Then you can extend the Foxx.Repository prototype and add your own methods.</p>
<p>If you do not give a model, it will default to the <code>Foxx.Model</code>. If you need more than the methods provided by it, you must give the path (relative to your lib directory) to your model module there. Then you can extend the Foxx.Model prototype and add your own methods.</p>
<p>If you don't need either of those, you don't need to give an empty object. You can then just call: </p>
<pre class="fragment">app.registerRepository("todos");
</pre><h4>Handling Requests</h4>
<p>If you do not redefine it, all requests that go to the root of your application will be redirected to <code>index.html</code>.</p>
<h5>Foxx.Application::head</h5>
<p>This handles requests from the HTTP verb <code>head</code>. As with all other requests you can give an option as the third argument, or leave it blank. You have to give a function as the last argument however. It will get a request and response object as its arguments </p>
<h5>Foxx.Application::get</h5>
<p>This handles requests from the HTTP verb <code>get</code>. See above for the arguments you can give. An example: <H3>Examples</H3><div class="fragment"><div class="line">app.get(<span class="stringliteral">&#39;/gaense/stall&#39;</span>, <span class="keyword">function</span> (req, res) {</div>
<div class="line">  <span class="doxy-comment">// Take this request and deal with it!</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::post</h5>
<p>This handles requests from the HTTP verb <code>post</code>. See above for the arguments you can give. An example: <H3>Examples</H3><div class="fragment"><div class="line">app.post(<span class="stringliteral">&#39;/gaense/stall&#39;</span>, <span class="keyword">function</span> (req, res) {</div>
<div class="line">  <span class="doxy-comment">// Take this request and deal with it!</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::put</h5>
<p>This handles requests from the HTTP verb <code>put</code>. See above for the arguments you can give. An example: <H3>Examples</H3><div class="fragment"><div class="line">app.put(<span class="stringliteral">&#39;/gaense/stall&#39;</span>, <span class="keyword">function</span> (req, res) {</div>
<div class="line">  <span class="doxy-comment">// Take this request and deal with it!</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::patch</h5>
<p>This handles requests from the HTTP verb <code>patch</code>. See above for the arguments you can give. An example: <H3>Examples</H3><div class="fragment"><div class="line">app.patch(<span class="stringliteral">&#39;/gaense/stall&#39;</span>, <span class="keyword">function</span> (req, res) {</div>
<div class="line">  <span class="doxy-comment">// Take this request and deal with it!</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::delete</h5>
<p>This handles requests from the HTTP verb <code>delete</code>. See above for the arguments you can give. <b>A word of warning:</b> Do not forget that <code>delete</code> is a reserved word in JavaScript and therefore needs to be called as app['delete']. There is also an alias <code>del</code> for this very reason. <H3>Examples</H3><div class="fragment"><div class="line">app[<span class="stringliteral">&#39;delete&#39;</span>](<span class="stringliteral">&#39;/gaense/stall&#39;</span>, <span class="keyword">function</span> (req, res) {</div>
<div class="line">  <span class="doxy-comment">// Take this request and deal with it!</span></div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">app.del(<span class="stringliteral">&#39;/gaense/stall&#39;</span>, <span class="keyword">function</span> (req, res) {</div>
<div class="line">  <span class="doxy-comment">// Take this request and deal with it!</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h4>Documenting and Constraining the Routes</h4>
<p>If you define a route like described above, you have the option to match parts of the URL to variables. If you for example define a route <code>/animals/:animal</code> and the URL <code>animals/foxx</code> is requested it is matched by this rule. You can then get the value of this variable (in this case "foxx") by calling <code>request.params("animal")</code>.</p>
<p>Furthermore you can describe your API by chaining the following methods onto your path definition. With the provided information, Foxx will generate a nice documentation for you. Some of the methods additionally will check certain properties of the request.</p>
<h5>Describing a pathParam</h5>
<p>Describe a Path Paramter: If you defined a route "/foxx/:id", you can constrain which format the id can have by giving a type. We currently support the following types:<ul>
<li>int</li>
<li>string</li>
</ul>
You can also provide a description of this parameter. <H3>Examples</H3><div class="fragment"><div class="line">app.get(<span class="stringliteral">&quot;/foxx/:id&quot;</span>, <span class="keyword">function</span> {</div>
<div class="line">  <span class="doxy-comment">// Do something</span></div>
<div class="line">}).pathParam(<span class="stringliteral">&quot;id&quot;</span>, {</div>
<div class="line">  description: <span class="stringliteral">&quot;Id of the Foxx&quot;</span>,</div>
<div class="line">  dataType: <span class="stringliteral">&quot;int&quot;</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Describing a queryParam</h5>
<p>Describe a Query Parameter: If you defined a route "/foxx", you can constrain which format a query parameter (<code>/foxx?a=12</code>) can have by giving it a type. We currently support the following types:<ul>
<li>int</li>
<li>string</li>
</ul>
You can also provide a description of this parameter, if it is required and if you can provide the parameter multiple times. <H3>Examples</H3><div class="fragment"><div class="line">app.get(<span class="stringliteral">&quot;/foxx&quot;</span>, <span class="keyword">function</span> {</div>
<div class="line">  <span class="doxy-comment">// Do something</span></div>
<div class="line">}).queryParam(<span class="stringliteral">&quot;id&quot;</span>, {</div>
<div class="line">  description: <span class="stringliteral">&quot;Id of the Foxx&quot;</span>,</div>
<div class="line">  dataType: <span class="stringliteral">&quot;int&quot;</span>,</div>
<div class="line">  required: <span class="keyword">true</span>,</div>
<div class="line">  allowMultiple: <span class="keyword">false</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Documenting the nickname of a route</h5>
<p>Set the nickname for this route in the documentation </p>
<h5>Documenting the summary of a route</h5>
<p>Set the summary for this route in the documentation Can't be longer than 60 characters </p>
<h5>Documenting the notes of a route</h5>
<p>Set the notes for this route in the documentation </p>
<h5>Documenting the error response of a route</h5>
<p>Document the error response for a given error code with a reason for the occurrence. </p>
<h4>Before and After Hooks</h4>
<p>You can use the following two functions to do something before or respectively after the normal routing process is happening. You could use that for logging or to manipulate the request or response (translate it to a certain format for example).</p>
<h5>Foxx.Application::before</h5>
<p>The before function takes a path on which it should watch and a function that it should execute before the routing takes place. If you do omit the path, the function will be executed before each request, no matter the path. Your function gets a Request and a Response object. An example: <H3>Examples</H3><div class="fragment"><div class="line">app.before(<span class="stringliteral">&#39;/high/way&#39;</span>, <span class="keyword">function</span>(req, res) {</div>
<div class="line">  <span class="doxy-comment">//Do some crazy request logging</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::after</h5>
<p>This works pretty similar to the before function. But it acts after the execution of the handlers (Big surprise, I suppose).An example: <H3>Examples</H3><div class="fragment"><div class="line">app.after(<span class="stringliteral">&#39;/high/way&#39;</span>, <span class="keyword">function</span>(req, res) {</div>
<div class="line">  <span class="doxy-comment">//Do some crazy response logging</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h4>More functionality</h4>
<h5>Foxx.Application::helper</h5>
<p>If you want to use a function inside your templates, the ViewHelpers will come to rescue you. Define them on your app like in the example.Then you can just call this function in your template's JavaScript blocks. <H3>Examples</H3><div class="fragment"><div class="line">app.helper(<span class="stringliteral">&quot;link_to&quot;</span>, <span class="keyword">function</span> (identifier) {</div>
<div class="line">  <span class="keywordflow">return</span> urlRepository[identifier];</div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Application::accepts</h5>
<p>Shortform for using the FormatMiddleware More information about the FormatMiddleware in the corresponding section. This is a shortcut to add the middleware to your application: <H3>Examples</H3><div class="fragment"><div class="line">app.accepts([<span class="stringliteral">&quot;json&quot;</span>], <span class="stringliteral">&quot;json&quot;</span>);</div>
</div><!-- fragment --> </p>
<h3>The Request and Response Objects</h3>
<p>When you have created your FoxxApplication you can now define routes on it. You provide each with a function that will handle the request. It gets two arguments (four, to be honest. But the other two are not relevant for now):</p>
<ul>
<li>The <code>request</code> object</li>
<li>The <code>response</code> object</li>
</ul>
<p>These objects are provided by the underlying ArangoDB actions and enhanced by the BaseMiddleware provided by Foxx.</p>
<h4>The <code>request</code> object</h4>
<p>Every request object has the following attributes from the underlying Actions, amongst others:</p>
<h5>request.path</h5>
<p>This is the complete path as supplied by the user as a String.</p>
<h5>request.body</h5>
<p>Get the body of the request </p>
<h5>request.params</h5>
<p>Get the parameters of the request. This process is two-fold:<ol type="1">
<li>If you have defined an URL like <code>/test/:id</code> and the user requested <code>/test/1</code>, the call <code>params("id")</code> will return <code>1</code>.</li>
<li>If you have defined an URL like <code>/test</code> and the user gives a query component, the query parameters will also be returned. So for example if the user requested <code>/test?a=2</code>, the call <code>params("a")</code> will return <code>2</code>. </li>
</ol>
</p>
<h4>The <code>response</code> object</h4>
<p>Every response object has the following attributes from the underlying Actions:</p>
<h5>request.body</h5>
<p>You provide your response body as a String here.</p>
<h5>request.status</h5>
<p>Set the status code of your response, for example: <H3>Examples</H3><div class="fragment"><div class="line">response.status(404);</div>
</div><!-- fragment --> </p>
<h5>request.set</h5>
<p>Set a header attribute, for example: <H3>Examples</H3><div class="fragment"><div class="line">response.set(<span class="stringliteral">&quot;Content-Length&quot;</span>, 123);</div>
<div class="line">response.set(<span class="stringliteral">&quot;Content-Type&quot;</span>, <span class="stringliteral">&quot;text/plain&quot;</span>);</div>
<div class="line"></div>
<div class="line"><span class="doxy-comment">// or alternatively:</span></div>
<div class="line"></div>
<div class="line">response.set({</div>
<div class="line">  <span class="stringliteral">&quot;Content-Length&quot;</span>: <span class="stringliteral">&quot;123&quot;</span>,</div>
<div class="line">  <span class="stringliteral">&quot;Content-Type&quot;</span>: <span class="stringliteral">&quot;text/plain&quot;</span></div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>request.json</h5>
<p>Set the content type to JSON and the body to the JSON encoded object you provided. <H3>Examples</H3><div class="fragment"><div class="line">response.json({<span class="stringliteral">&#39;born&#39;</span>: <span class="stringliteral">&#39;December 12, 1915&#39;</span>});</div>
</div><!-- fragment --> </p>
<h5>request.render</h5>
<p>If you initialize your Application with a <code>templateCollection</code>, you're in luck now. It expects documents in the following form in this collection: </p>
<pre class="fragment">{
  path: "high/way",
  content: "hello &lt;%= username %&gt;",
  contentType: "text/plain",
  templateLanguage: "underscore"
}
</pre>The <code>content</code> is the string that will be rendered by the template processor. The <code>contentType</code> is the type of content that results from this call. And with the <code>templateLanguage</code> you can choose your template processor. There is only one choice now: <code>underscore</code>.If you call render, Application will look into the this collection and search by the path attribute. It will then render the template with the given data:Which would set the body of the response to <code>hello Application</code> with the template defined above. It will also set the <code>contentType</code> to <code>text/plain</code> in this case.In addition to the attributes you provided, you also have access to all your view helpers. How to define them? Read above in the ViewHelper section. <H3>Examples</H3><div class="fragment"><div class="line">response.render(<span class="stringliteral">&quot;high/way&quot;</span>, {username: <span class="stringliteral">&#39;Application&#39;</span>})</div>
</div><!-- fragment --> </p>
<h3>Foxx.Model</h3>
<p>Foxx = require("org/arangodb/foxx");</p>
<p>TodoModel = Foxx.Model.extend({ });</p>
<p>exports.model = TodoModel;</p>
<p>The model doesn't know anything about the database. It is just a representation of the data as an JavaScript object. You can add and overwrite the methods of the prototype in your model prototype via the object you give to extend. In your model file, export the model as <code>model</code>.</p>
<p>A Foxx Model can be initialized with an object of attributes and their values.</p>
<h5>Foxx.Model.extend</h5>
<p>Extend the Model prototype to add or overwrite methods. </p>
<h5>new Foxx.Model</h5>
<p>If you initialize a model, you can give it initial data as an object. <H3>Examples</H3><div class="fragment"><div class="line">instance = <span class="keyword">new</span> Model({</div>
<div class="line">  a: 1</div>
<div class="line">});</div>
</div><!-- fragment --> </p>
<h5>Foxx.Model::get</h5>
<p>Get the value of an attribute  <H3>Examples</H3><div class="fragment"><div class="line">instance = <span class="keyword">new</span> Model({</div>
<div class="line">  a: 1</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">instance.get(<span class="stringliteral">&quot;a&quot;</span>);</div>
</div><!-- fragment --> </p>
<h5>Foxx.Model::set</h5>
<p>Set the value of an attribute  <H3>Examples</H3><div class="fragment"><div class="line">instance = <span class="keyword">new</span> Model({</div>
<div class="line">  a: 1</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">instance.set(<span class="stringliteral">&quot;a&quot;</span>, 2);</div>
</div><!-- fragment --> </p>
<h5>Foxx.Model::has</h5>
<p>Returns true if the attribute is set to a non-null or non-undefined value.  <H3>Examples</H3><div class="fragment"><div class="line">instance = <span class="keyword">new</span> Model({</div>
<div class="line">  a: 1</div>
<div class="line">});</div>
<div class="line"></div>
<div class="line">instance.has(<span class="stringliteral">&quot;a&quot;</span>); <span class="doxy-comment">//=&gt; true</span></div>
<div class="line">instance.has(<span class="stringliteral">&quot;b&quot;</span>); <span class="doxy-comment">//=&gt; false</span></div>
</div><!-- fragment --> </p>
<h5>Foxx.Model::attributes</h5>
<p>The attributes property is the internal hash containing the model's state.</p>
<h5>Foxx.Model::toJSON</h5>
<p>Return a copy of the model which can be saved into ArangoDB (or send to the client). </p>
<h3>Foxx.Repository</h3>
<p>A repository is a gateway to the database. It gets data from the database, updates it or saves new data. It uses the given model when it returns a model and expects instances of the model for methods like save. In your repository file, export the repository as <code>repository</code>.</p>
<p>Foxx = require("org/arangodb/foxx");</p>
<p>TodosRepository = Foxx.Repository.extend({ });</p>
<p>exports.repository = TodosRepository;</p>
<h5>new Foxx.Repository</h5>
<p>Create a new instance of Repository A Foxx Repository is always initialized with the prefix, the collection and the modelPrototype. If you initialize a model, you can give it initial data as an object. <H3>Examples</H3><div class="fragment"><div class="line">instance = <span class="keyword">new</span> Repository(prefix, collection, modelPrototype);</div>
</div><!-- fragment --> </p>
<h5>Foxx.Repository::collection</h5>
<p>The collection object.</p>
<h5>Foxx.Repository::prefix</h5>
<p>The prefix of the application.</p>
<h5>Foxx.Repository::modelPrototype</h5>
<p>The prototype of the according model.</p>
<h5>Foxx.Repository::save</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::remove</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::replace</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::update</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::removeByExample</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::replaceByExample</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::updateByExample</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::all</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::byExample</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h5>Foxx.Repository::firstExample</h5>
<p><b>Not implemented</b> See the documentation of collection (will be delegated to the collection).</p>
<h3>The Manifest File</h3>
<p>In the <code>manifest.json</code> you define the components of your application: The content is a JSON object with the following keys:</p>
<ul>
<li><code>name</code>: Name of the application (Meta information)</li>
<li><code>version</code>: Current version of the application (Meta information)</li>
<li><code>description</code>: A short description of the application (Meta information)</li>
<li><code>thumbnail</code>: Path to a thumbnail that represents the application (Meta information)</li>
<li><code>apps</code>: Map routes to FoxxApplications</li>
<li><code>lib</code>: Base path for all required modules</li>
<li><code>files</code>: Deliver files</li>
<li><code>assets</code>: Deliver pre-processed files</li>
<li><code>system</code>: Mark an application as a system application</li>
<li><code>setup</code>: Path to a setup script</li>
<li><code>teardown</code>: Path to a teardown script</li>
</ul>
<p>A more complete example for a Manifest file: </p>
<pre class="fragment">{
  "name": "my_website",
  "version": "1.2.1",
  "description": "My Website with a blog and a shop",
  "thumnail": "images/website-logo.png",

  "apps": {
    "/blog": "apps/blog.js",
    "/shop": "apps/shop.js"
  },

  "lib": "lib",

  "files": {
    "/images": "images"
  },

  "assets": {
    "application.js": {
      "files": [
        "vendor/jquery.js",
        "assets/javascripts/*"
      ]
    }
  },

  "setup": "scripts/setup.js",
  "teardown": "scripts/teardown.js"
}
</pre><h4><code>setup</code> and <code>teardown</code></h4>
<p>You can provide a path to a JavaScript file that prepares ArangoDB for your application (or respectively removes it entirely). These scripts have access to <code>appCollection</code> and <code>appCollectionName</code> just like models. Use the <code>setup</code> script to create all collections your application needs and fill them with initial data if you want to. Use the <code>teardown</code> script to remove all collections you have created.</p>
<h4><code>apps</code> is an object that matches routes to files:</h4>
<ul>
<li>The <code>key</code> is the route you want to mount at</li>
<li>The <code>value</code> is the path to the JavaScript file containing the <code>FoxxApplication</code> you want to mount</li>
</ul>
<p>You can add multiple applications in one manifest this way.</p>
<h4>The <code>files</code></h4>
<p>Deliver all files in a certain folder without modifying them. You can deliver text files as well as binaries: </p>
<pre class="fragment">"files": {
  "/images": "images"
}
</pre><h4>The <code>assets</code></h4>
<p>The value for the asset key is an object consisting of paths that are matched to the files they are composed of. Let's take the following example:</p>
<p>"assets": { "application.js": { "files": [ "vendor/jquery.js", "assets/javascripts/*" ] } }</p>
<p>If a request is made to <code>/application.js</code> (in development mode), the file array provided will be processed one element at a time. The elements are paths to files (with the option to use wildcards). The files will be concatenated and delivered as a single file.</p>
<h3>Development Mode</h3>
<p>If you start ArangoDB with the option <code>--javascript.dev-app-path</code> followed by the path to a directory containing a manifest file and the path to the database, you are starting ArangoDB in development mode with the application loaded. This means that on every request:</p>
<ol type="1">
<li>All routes are dropped</li>
<li>All module caches are flushed</li>
<li>Your manifest file is read</li>
<li>All files in your lib folder are loaded</li>
<li>All <code>apps</code> are executed. Each <code>app.start()</code> will put the routes in a temporary route object, prefixed with the path given in the manifest</li>
<li>All routes in the temporary route object are stored to the routes</li>
<li>The request will be processed</li>
</ol>
<p>This means that you do not have to restart ArangoDB if you change anything in your app. It is of course not meant for production, because the reloading makes the app relatively slow.</p>
<h3>Deploying on Production</h3>
<p><em>The Production mode is in development right now.</em> We will offer the option to process all assets at once and write the files to disk for production with the option to run <code>Uglify2.js</code> and similar tools in order to compress them.</p>
<h3>Optional Functionality: FormatMiddleware</h3>
<p>Unlike the <code>BaseMiddleware</code> this Middleware is only loaded if you want it. This Middleware gives you Rails-like format handling via the <code>extension</code> of the URL or the accept header. Say you request an URL like <code>/people.json</code>:</p>
<p>The <code>FormatMiddleware</code> will set the format of the request to JSON and then delete the <code>.json</code> from the request. You can therefore write handlers that do not take an <code>extension</code> into consideration and instead handle the format via a simple String. To determine the format of the request it checks the URL and then the <code>accept</code> header. If one of them gives a format or both give the same, the format is set. If the formats are not the same, an error is raised.</p>
<p>Use it by calling: </p>
<pre class="fragment">FormatMiddleware = require('foxx').FormatMiddleware;
app.before("/*", FormatMiddleware.new(['json']));
</pre><p>or the shortcut: </p>
<pre class="fragment">app.accepts(['json']);
</pre><p>In both forms you can give a default format as a second parameter, if no format could be determined. If you give no <code>defaultFormat</code> this case will be handled as an error. </p>
</div></div><!-- contents -->
</div>


	  </div><!-- .entry-content -->
	</div><!-- #post-## -->


      <div id="comments">


  <p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


      </div><!-- #content -->
    </div><!-- #container -->

  <div style="clear:both;"></div>
  </div><!-- #main -->



</div><!-- #wrapper -->
</div><!-- #surrounding -->


  <div id="footer" role="contentinfo">
    <div id="colophon">




      <div id="footer-widget-area" role="complementary">

	<div id="first" class="widget-area">
	  <ul class="xoxo">
		<li id="recent-posts-4" class="widget-container widget_recent_entries">	  <h3 class="widget-title">Recent Posts</h3>	<ul>
	  <li>
	<a href="http://www.arangodb.org/2013/05/22/replication-and-sharding-in-arangodb" title="Our plans on replication and sharding in ArangoDB">Our plans on replication and sharding in ArangoDB</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/14/ideas-and-facts-from-scotland-js-in-edinburgh" title="Ideas and Facts from scotland.js in Edinburgh">Ideas and Facts from scotland.js in Edinburgh</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/12/arangodb-1-3-0-released" title="ArangoDB 1.3.0 released">ArangoDB 1.3.0 released</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/06/foxx-screencast-part-2" title="Foxx Screencast: Part 2">Foxx Screencast: Part 2</a>
	    </li>
	</ul>
    </li><li id="text-5" class="widget-container widget_text"><h3 class="widget-title">Documentation</h3>     <div class="textwidget"><ul>
  <li><a href="/quickstart">First step tutorial</a></li>
  <li><a href="/manuals">Manual/documentation (HTML/PDF)</a></li>
  <li><a href="/manuals/arangodb_1.0_shell_reference_card.pdf">ArangoDB Shell Reference Card (HTML/PDF)</a></li>
  <li><a href="/try">Try ArangoDB online</a></li>
  <li><a href="/api">API clients & 3rd party libs</a></li>
        <li><a href="/logos">ArangoDB artwork/logos</a></li>
</ul>
</div>
    </li><li id="text-7" class="widget-container widget_text"><h3 class="widget-title">Social Links</h3>      <div class="textwidget"><ul>
  <li><a href="https://twitter.com/arangodb">ArangoDB on Twitter</a></li>
  <li><a href="https://groups.google.com/group/arangodb">ArangoDB Google Group</a></li>
  <li><a href="http://stackoverflow.com/questions/tagged/arangodb">ArangoDB questions on StackOverflow</a></li>
  <li><a href="https://github.com/triagens/arangodb/issues?state=open">Issue Tracker at Github</a></li>
</ul></div>
    </li><li id="text-6" class="widget-container widget_text"><h3 class="widget-title">Roadmap</h3>	<div class="textwidget"><ul>
  <li><a href="/roadmap/#v1.4">Backlog for Version 1.4</a></li>
  <li><a href="/roadmap/#v1.x">Backlog for Version 1.x</a></li>
</ul></div>
    </li>	  </ul>
	</div><!-- #first .widget-area -->




      </div><!-- #footer-widget-area -->


<!-- #site-generator -->

    </div><!-- #colophon -->

        <div class="copy">
            Copyright 2013 ArangoDB | <a href="/imprint">Imprint</a>
        </div>

  </div><!-- #footer -->

</body>
</html>