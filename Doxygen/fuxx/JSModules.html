<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


<link rel="shortcut icon" type="image/x-icon" href="http://www.arangodb.org/wp-content/themes/triagens/images/favicon.ico">

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.arangodb.org/wp-content/themes/triagens-child/style.css" />
<link rel="pingback" href="" />


<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.4 - http://yoast.com/wordpress/seo/ -->
<title>ArangoDB Manual Pages - ArangoDB</title>
<meta name="description" content="ArangoDB Manual Pages"/>
<link rel="canonical" href="http://www.arangodb.org/manualredirector" />
<meta property='og:locale' content='en_US'/>
<meta property='og:title' content='ArangoDB Manual Pages - ArangoDB'/>
<meta property='og:description' content='ArangoDB Manual Pages'/>
<meta property='og:url' content='http://www.arangodb.org/manualredirector'/>
<meta property='og:site_name' content='ArangoDB'/>
<meta property='og:type' content='article'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Feed" href="http://www.arangodb.org/feed" />
<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Comments Feed" href="http://www.arangodb.org/comments/feed" />
<link rel='stylesheet' id='wordpress-popular-posts-css'  href='http://www.arangodb.org/wp-content/plugins/wordpress-popular-posts/style/wpp.css?ver=3.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.arangodb.org/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>

    <style type="text/css">
    body {
    margin-top: -28px;
    padding-bottom: 28px;
    }
    body.admin-bar #wphead {
       padding-top: 0;
    }
    body.admin-bar #footer {
       padding-bottom: 28px;
    }
<link type="text/css" media="screen" rel="stylesheet" href="http://www.arangodb.org/wp-content/plugins/tweet-blender/css/tweets.css" />

    <style media="print" type="text/css">
      div.faq_answer {display: block!important;}
      p.faq_nav {display: none;}
    </style>


</head>

<body class="page page-id-1410 page-template page-template-onecolumn-page-php">

    <div id="access" role="navigation">
        <div id="nav">
            <a href="http://www.arangodb.org/" title="ArangoDB" id="branding"><img src="/wp-content/themes/triagens/images/logo_arangob_white.gif" width="154" height="34" alt="ArangoDB"></a>
            <div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-184" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-184"><a href="http://www.arangodb.org/">Home</a></li>
<li id="menu-item-1345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1345"><a href="http://www.arangodb.org/try">Try it out</a></li>
<li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://www.arangodb.org/documentation">Documentation</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-95"><a href="http://www.arangodb.org/roadmap">Roadmap</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="http://www.arangodb.org/download">Downloads</a></li>
<li id="menu-item-1299" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1299"><a href="http://www.arangodb.org/api">Drivers</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://www.arangodb.org/blog">Blog</a></li>
</ul></div>            <div class="clear_both"></div>
        </div>
    </div><!-- #access -->

  <div id="surrounding">

    <div id="wrapper" class="hfeed">
	<div id="main">

    <div id="fullsize" class="one-column">
      <div id="content" role="main">



            <div id="post-1410" class="post-1410 page type-page status-publish hentry">
                    <h2 class="entry-title">ArangoDB Manual Pages</h2>

	  <div class="entry-content">

<link id="arangodb.css" type="text/css" href="arangodb.css" rel="stylesheet">
</div>
<div id="manual_search">
<form action="/" id="searchform" method="get" role="search">
  <div><label for="s" class="screen-reader-text">Search for:</label>
    <input type="text" id="s" name="s" value="" />
    <input type="submit" value="Search" id="searchsubmit" />
  </div>
</form>
</div>
<div class="clear_both"></div>
<hr />
<div class="arangodb">
<div>
<!-- Generated by Doxygen 1.8.2 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">JavaScript Modules </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> <div class="navigate">prev | <a href="RefManual.html">home</a> | <a href="JSModuleConsole.html">next</a></div>  <div class="toc"><ul>
<li><a class="el" href="JSModules.html">JavaScript Modules</a><ul>
<li><a class="el" href="JSModules.html#JSModulesIntro">Introduction to Javascript Modules</a><ul>
<li><a class="el" href="JSModules.html#JSModulesCommonJS">CommonJS Modules</a></li>
<li><a class="el" href="JSModules.html#JSModulesArangoDB">ArangoDB Specific Modules</a></li>
<li><a class="el" href="JSModules.html#JSModulesNode">Node Modules</a></li>
<li><a class="el" href="JSModules.html#JSModulesNPM">Node Packages</a></li>
<li><a class="el" href="JSModules.html#JSModulesRequire">require</a></li>
</ul>
</li>
<li><a class="el" href="JSModules.html#JSModulesPath">Modules Path versus Modules Collection</a><ul>
<li><a class="el" href="JSModules.html#JSModulesNormalization">Path Normalization</a></li>
<li><a class="el" href="JSModules.html#JSModulesCache">Modules Cache</a> </li>
</ul>
</li>
</ul>
</li>
</ul>
  </div> <h2><a class="anchor" id="JSModulesIntro"></a>
Introduction to Javascript Modules</h2>
<p>The ArangoDB uses a <a href="http://wiki.commonjs.org/wiki">CommonJS</a> compatible module and package concept. You can use the function  <span class="functionname">require</span> in order to load a module or package. It returns the exported variables and functions of the module or package.</p>
<h3><a class="anchor" id="JSModulesCommonJS"></a>
CommonJS Modules</h3>
<p>Unfortunately, the JavaScript libraries are just in the process of being standardized. CommonJS has defined some important modules. ArangoDB implements the following</p>
<ul>
<li>"console" is a well known logging facility to all the JavaScript developers. ArangoDB implements all of the functions described <a href="http://wiki.commonjs.org/wiki/Console">here</a>, with the exceptions of <code>profile</code> and <code>count</code>.</li>
</ul>
<ul>
<li>"fs" provides a file system API for the manipulation of paths, directories, files, links, and the construction of file streams. ArangoDB implements most of Filesystem/A functions described <a href="http://wiki.commonjs.org/wiki/Filesystem/A">here</a>.</li>
</ul>
<ul>
<li>Modules are implemented according to <a href="http://wiki.commonjs.org/wiki/Modules">Modules/1.1.1</a></li>
</ul>
<ul>
<li>Packages are implemented according to <a href="http://wiki.commonjs.org/wiki/Packages">Packages/1.0</a></li>
</ul>
<h3><a class="anchor" id="JSModulesArangoDB"></a>
ArangoDB Specific Modules</h3>
<p>A lot of the modules, however, are ArangoDB specific. These are described in the following chapters. You can use the command-line option  <span class="commandoption">startup.modules-path</span> to specify the location of the JavaScript files.</p>
<h3><a class="anchor" id="JSModulesNode"></a>
Node Modules</h3>
<p>ArangoDB also support some <a href="http://www.nodejs.org/">node</a> modules.</p>
<ul>
<li><a href="http://www.nodejs.org/api/assert.html">"assert"</a> implements assertion and testing functions.</li>
</ul>
<ul>
<li><a href="http://www.nodejs.org/api/buffer.html">"buffer"</a> implements a binary data type for JavaScript.</li>
</ul>
<ul>
<li><a href="http://www.nodejs.org/api/path.html">"path"</a> implements functions dealing with filenames and paths.</li>
</ul>
<ul>
<li><a href="http://www.nodejs.org/api/punycode.html">"punycode"</a> implements conversion functions for <a href="http://en.wikipedia.org/wiki/Punycode">punycode</a> encoding.</li>
</ul>
<ul>
<li><a href="http://www.nodejs.org/api/querystring.html">"querystring"</a> provides utilities for dealing with query strings.</li>
</ul>
<ul>
<li><a href="http://www.nodejs.org/api/url.html">"url"</a> has utilities for URL resolution and parsing.</li>
</ul>
<h3><a class="anchor" id="JSModulesNPM"></a>
Node Packages</h3>
<p>The following <a href="https://npmjs.org/">node packages</a> are preinstalled.</p>
<ul>
<li><a href="http://underscorejs.org/">"underscore"</a> is a utility-belt library for JavaScript that provides a lot of the functional programming support that you would expect in Prototype.js (or Ruby), but without extending any of the built-in JavaScript objects.</li>
</ul>
<ul>
<li><a href="http://coffeescript.org/">"coffee-script"</a> implements a coffee-script to JavaScript compiler. ArangoDB supports the <code>compile</code> function of the package, but not the <code>eval</code> functions.</li>
</ul>
<p>You can use the command-line option  <span class="commandoption">startup.package-path</span> to specify the location of the node packages.</p>
<h3><a class="anchor" id="JSModulesRequire"></a>
require</h3>
 <div class="functionsignature">require(<span class="functionargument">path</span>) </div> <span class="functionname">require</span> checks if the module or package specified by  <span class="functionargument">path</span> has already been loaded. If not, the content of the file is executed in a new context. Within the context you can use the global variable <code>exports</code> in order to export variables and functions. This variable is returned by  <span class="functionname">require</span>.</p>
<p>Assume that your module file is <code>test1.js</code> and contains </p>
<pre class="fragment">exports.func1 = function() {
  print("1");
};

exports.const1 = 1;
</pre><p>Then you can use  <span class="functionname">require</span> to load the file and access the exports. </p>
<pre class="fragment">unix&gt; ./arangod --console /tmp/vocbase
arangod&gt; var test1 = require("test1");

arangod&gt; test1.const1;
1

arangod&gt; test1.func1();
1
</pre> <span class="functionname">require</span> follows the specification <a href="http://wiki.commonjs.org/wiki/Modules/1.1.1">Modules/1.1.1</a>.</p>
<h2><a class="anchor" id="JSModulesPath"></a>
Modules Path versus Modules Collection</h2>
<p>ArangoDB comes with predefined modules defined in the file-system under the path specified by  <span class="commandoption">startup.modules-path</span>. In a standard installation this point to the system share directory. Even if you are an administrator of ArangoDB you might not have write permissions to this location. On the other hand, in order to deploy some extension for ArangoDB, you might need to install additional JavaScript modules. This would require you to become root and copy the files into the share directory. In order to easy the deployment of extensions, ArangoDB uses a second mechanism to look up JavaScript modules.</p>
<p>JavaScript modules can either be stored in the filesystem as regular file or in the database collection <code>_modules</code>.</p>
<p>Given the directory paths </p>
<pre class="fragment">/usr/share/arangodb/A;/usr/share/arangodb/B
</pre><p>for  <span class="commandoption">startup.modules-path</span>. If you execute </p>
<pre class="fragment">require("com/example/extension")
</pre><p>then ArangoDB will try to locate the corresponding JavaScript as file as follows</p>
<ul>
<li>There is a cache for the results of previous <code>require</code> calls. First of all ArangoDB checks if <code>com/example/extension</code> is already in the modules cache. If it is, the export object for this module is returned. No further JavaScript is executed.</li>
</ul>
<ul>
<li><p class="startli">ArangoDB will then check, if there is a file called</p>
<p class="startli">/usr/share/arangodb/A/com/example/extension.js</p>
<p class="startli">If such a file exists, it is executed in a new module context and the value of <code>exports</code> object is returned. This value is also stored in the module cache.</p>
</li>
</ul>
<ul>
<li><p class="startli">Next the file</p>
<p class="startli">/usr/share/arangodb/B/com/example/extension.js</p>
<p class="startli">is checked.</p>
</li>
</ul>
<ul>
<li><p class="startli">If no file can be found, ArangoDB will check if the collection <code>modules</code> contains a document of the form </p>
<pre class="fragment">{
  path: "com/example/extension",
  content: "...."
}
</pre><p class="startli">If such a document exists, then the value of the <code>content</code> attribute must contain the JavaScript code of the module. This string is executed in a new module context and the value of <code>exports</code> object is returned. This value is also stored in the module cache.</p>
</li>
</ul>
<h3><a class="anchor" id="JSModulesNormalization"></a>
Path Normalization</h3>
<p>If you <code>require</code> a module, the path is normalized according the CommonJS rules and an absolute path is used to look up the module. However, the leading <code>/</code> is omitted. Therefore, you should always use absolute paths without a leading <code>/</code> when storing modules in the <code>_modules</code> collection.</p>
<p>For example, if you execute </p>
<pre class="fragment">require("./lib/../extra/world");
</pre><p>within a module <code>com/example</code> the path used for look-up will be </p>
<pre class="fragment">com/example/extra/world
</pre><h3><a class="anchor" id="JSModulesCache"></a>
Modules Cache</h3>
<p>As <code>require</code> uses a module cache to store the exports objects of the required modules, changing the design documents for the modules in the <code>_modules</code> collection might have no effect at all.</p>
<p>You need to clear the cache, when manually changing documents in the <code>_modules</code> collection. </p>
<pre class="fragment">arangosh&gt; require("internal").flushServerModules()
</pre><p>This initiate a flush of the modules in the ArangoDB <em>server</em> process.</p>
<p>Please note, that the ArangoDB JavaScript shell uses the same mechanism as the server to locate JavaScript modules. But the do not share the same module cache. If you flush the server cache, this will not flush the shell cache - and vice versa.</p>
<p>In order to flush the modules cache of the JavaScript shell, you should use </p>
<pre class="fragment">arangosh&gt; require("internal").flushModuleCache()</pre> </div></div><!-- contents -->
</div>


	  </div><!-- .entry-content -->
	</div><!-- #post-## -->


      <div id="comments">


  <p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


      </div><!-- #content -->
    </div><!-- #container -->

  <div style="clear:both;"></div>
  </div><!-- #main -->



</div><!-- #wrapper -->
</div><!-- #surrounding -->


  <div id="footer" role="contentinfo">
    <div id="colophon">




      <div id="footer-widget-area" role="complementary">

	<div id="first" class="widget-area">
	  <ul class="xoxo">
		<li id="recent-posts-4" class="widget-container widget_recent_entries">	  <h3 class="widget-title">Recent Posts</h3>	<ul>
	  <li>
	<a href="http://www.arangodb.org/2013/05/22/replication-and-sharding-in-arangodb" title="Our plans on replication and sharding in ArangoDB">Our plans on replication and sharding in ArangoDB</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/14/ideas-and-facts-from-scotland-js-in-edinburgh" title="Ideas and Facts from scotland.js in Edinburgh">Ideas and Facts from scotland.js in Edinburgh</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/12/arangodb-1-3-0-released" title="ArangoDB 1.3.0 released">ArangoDB 1.3.0 released</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/06/foxx-screencast-part-2" title="Foxx Screencast: Part 2">Foxx Screencast: Part 2</a>
	    </li>
	</ul>
    </li><li id="text-5" class="widget-container widget_text"><h3 class="widget-title">Documentation</h3>     <div class="textwidget"><ul>
  <li><a href="/quickstart">First step tutorial</a></li>
  <li><a href="/manuals">Manual/documentation (HTML/PDF)</a></li>
  <li><a href="/manuals/arangodb_1.0_shell_reference_card.pdf">ArangoDB Shell Reference Card (HTML/PDF)</a></li>
  <li><a href="/try">Try ArangoDB online</a></li>
  <li><a href="/api">API clients & 3rd party libs</a></li>
        <li><a href="/logos">ArangoDB artwork/logos</a></li>
</ul>
</div>
    </li><li id="text-7" class="widget-container widget_text"><h3 class="widget-title">Social Links</h3>      <div class="textwidget"><ul>
  <li><a href="https://twitter.com/arangodb">ArangoDB on Twitter</a></li>
  <li><a href="https://groups.google.com/group/arangodb">ArangoDB Google Group</a></li>
  <li><a href="http://stackoverflow.com/questions/tagged/arangodb">ArangoDB questions on StackOverflow</a></li>
  <li><a href="https://github.com/triagens/arangodb/issues?state=open">Issue Tracker at Github</a></li>
</ul></div>
    </li><li id="text-6" class="widget-container widget_text"><h3 class="widget-title">Roadmap</h3>	<div class="textwidget"><ul>
  <li><a href="/roadmap/#v1.4">Backlog for Version 1.4</a></li>
  <li><a href="/roadmap/#v1.x">Backlog for Version 1.x</a></li>
</ul></div>
    </li>	  </ul>
	</div><!-- #first .widget-area -->




      </div><!-- #footer-widget-area -->


<!-- #site-generator -->

    </div><!-- #colophon -->

        <div class="copy">
            Copyright 2013 ArangoDB | <a href="/imprint">Imprint</a>
        </div>

  </div><!-- #footer -->

</body>
</html>