<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


<link rel="shortcut icon" type="image/x-icon" href="http://www.arangodb.org/wp-content/themes/triagens/images/favicon.ico">

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.arangodb.org/wp-content/themes/triagens-child/style.css" />
<link rel="pingback" href="" />


<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.4 - http://yoast.com/wordpress/seo/ -->
<title>ArangoDB Manual Pages - ArangoDB</title>
<meta name="description" content="ArangoDB Manual Pages"/>
<link rel="canonical" href="http://www.arangodb.org/manualredirector" />
<meta property='og:locale' content='en_US'/>
<meta property='og:title' content='ArangoDB Manual Pages - ArangoDB'/>
<meta property='og:description' content='ArangoDB Manual Pages'/>
<meta property='og:url' content='http://www.arangodb.org/manualredirector'/>
<meta property='og:site_name' content='ArangoDB'/>
<meta property='og:type' content='article'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Feed" href="http://www.arangodb.org/feed" />
<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Comments Feed" href="http://www.arangodb.org/comments/feed" />
<link rel='stylesheet' id='wordpress-popular-posts-css'  href='http://www.arangodb.org/wp-content/plugins/wordpress-popular-posts/style/wpp.css?ver=3.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.arangodb.org/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>

    <style type="text/css">
    body {
    margin-top: -28px;
    padding-bottom: 28px;
    }
    body.admin-bar #wphead {
       padding-top: 0;
    }
    body.admin-bar #footer {
       padding-bottom: 28px;
    }
<link type="text/css" media="screen" rel="stylesheet" href="http://www.arangodb.org/wp-content/plugins/tweet-blender/css/tweets.css" />

    <style media="print" type="text/css">
      div.faq_answer {display: block!important;}
      p.faq_nav {display: none;}
    </style>


</head>

<body class="page page-id-1410 page-template page-template-onecolumn-page-php">

    <div id="access" role="navigation">
        <div id="nav">
            <a href="http://www.arangodb.org/" title="ArangoDB" id="branding"><img src="/wp-content/themes/triagens/images/logo_arangob_white.gif" width="154" height="34" alt="ArangoDB"></a>
            <div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-184" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-184"><a href="http://www.arangodb.org/">Home</a></li>
<li id="menu-item-1345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1345"><a href="http://www.arangodb.org/try">Try it out</a></li>
<li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://www.arangodb.org/documentation">Documentation</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-95"><a href="http://www.arangodb.org/roadmap">Roadmap</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="http://www.arangodb.org/download">Downloads</a></li>
<li id="menu-item-1299" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1299"><a href="http://www.arangodb.org/api">Drivers</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://www.arangodb.org/blog">Blog</a></li>
</ul></div>            <div class="clear_both"></div>
        </div>
    </div><!-- #access -->

  <div id="surrounding">

    <div id="wrapper" class="hfeed">
	<div id="main">

    <div id="fullsize" class="one-column">
      <div id="content" role="main">



            <div id="post-1410" class="post-1410 page type-page status-publish hentry">
                    <h2 class="entry-title">ArangoDB Manual Pages</h2>

	  <div class="entry-content">

<link id="arangodb.css" type="text/css" href="arangodb.css" rel="stylesheet">
</div>
<div id="manual_search">
<form action="/" id="searchform" method="get" role="search">
  <div><label for="s" class="screen-reader-text">Search for:</label>
    <input type="text" id="s" name="s" value="" />
    <input type="submit" value="Search" id="searchsubmit" />
  </div>
</form>
</div>
<div class="clear_both"></div>
<hr />
<div class="arangodb">
<div>
<!-- Generated by Doxygen 1.8.2 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">New Features in ArangoDB 1.3 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> <div class="navigate">prev | <a href="Home.html">home</a> | <a href="Upgrading13.html">next</a></div>  <div class="toc"><ul>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Introduction">Features and Improvements </a><ul>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Datafile">Changes to the Datafile Structure</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Foxx">Rapid API Development with FOXX</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Transactions">Transactions</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Admin">New Administration Interface</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Statistics">New Server Statistics</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13AQL">AQL extensions</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Node">Node Modules and Packages</a></li>
<li><a class="el" href="NewFeatures13.html#NewFeatures13Misc">Miscelleanous changes</a> </li>
</ul>
</li>
</ul>
  </div> <h2><a class="anchor" id="NewFeatures13Introduction"></a>
Features and Improvements </h2>
<p>The following list shows in detail which features have been added or improved in ArangoDB 1.3. ArangoDB 1.3 also contains several bugfixes that are not listed here.</p>
<h3><a class="anchor" id="NewFeatures13Datafile"></a>
Changes to the Datafile Structure</h3>
<p>As the datafile structure has changed, please read the <a class="el" href="Upgrading13.html">upgrade manual</a> carefully.</p>
<h3><a class="anchor" id="NewFeatures13Foxx"></a>
Rapid API Development with FOXX</h3>
<p>A preview of the forthcoming Foxx is contained in 1.3. Please note that this is not the final version, Foxx is still experimental.</p>
<p>Foxx is a lightweight Javascript "micro framework" which allows you to build applications directly on top of ArangoDB and therefore skip the middleman (Rails, Django, Symfony or whatever your favorite web framework is). Inspired by frameworks like Sinatra Foxx is designed with simplicity and the specific use case of modern client-side MVC frameworks in mind.</p>
<p>The screencast at <a href="http://foxx.arangodb.org">http://foxx.arangodb.org</a> explains how to use Foxx.</p>
<h3><a class="anchor" id="NewFeatures13Transactions"></a>
Transactions</h3>
<p>ArangoDB provides server-side transactions that allow executing multi-document and even multi-collection operations with ACID guarantees.</p>
<p>Transactions in ArangoDB are defined by providing a JavaScript object which needs to contain the transaction code, and some declarations about the collections involved in the transaction.</p>
<p>The transaction code will be executed by the server en bloc. If execution of any statement in the transaction code fails for whatever reason, the entire transaction will be aborted and rolled back.</p>
<p>Data modifications done by transactions become visible to following transactions only when a transaction succeeds. Data modifications that are performed by a still-ongoing transaction are not exposed to other parallel transactions. In fact, transactions on the same collection will be executed serially.</p>
<p>The following example will atomically transfer money from one user account to another: </p>
<pre class="fragment">db._create("accounts");
db.accounts.save({ _key: "john", amount: 423 });
db.accounts.save({ _key: "fred", amount: 197 });

db._executeTransaction({
  collections: {
    write: "accounts"
  },
  params: {
    user1: "fred",
    user2: "john", 
    amount: 10
  },
  action: function (params) {
    var db = require("internal").db;
    var account1 = db.accounts.document(params['user1']);
    var account2 = db.accounts.document(params['user2']);
    var amount = params['amount'];

    if (account1.amount &lt; amount) {
      throw "account of user '" + user1 + "' does not have enough money!";
    }

    db.accounts.update(account1, { amount : account1.amount - amount });
    db.accounts.update(account2, { amount : account2.amount + amount });

    /* will commit the transaction and return the value true */
    return true; 
  }
});
</pre><p>Please refer to <a class="el" href="Transactions.html">Transactions</a> for more details and examples on transaction usage in ArangoDB.</p>
<h3><a class="anchor" id="NewFeatures13Admin"></a>
New Administration Interface</h3>
<p>ArangoDB 1.3 comes with a new administration front-end. The front-end is now based on backbone and uses repl.it, which allows for instance line editing when using the browser based ArangoDB shell.</p>
<p>Please note, that the "Application" tab belongs to the forthcoming <a class="el" href="NewFeatures13.html#NewFeatures13Foxx">Rapid API Development with FOXX</a> Foxx. The functionality below this tab is neither stable nor complete. It has been shipped as a feature preview.</p>
<h3><a class="anchor" id="NewFeatures13Statistics"></a>
New Server Statistics</h3>
<p>The server statistics provided by ArangoDB have been changed in 1.3.</p>
<p>Before version 1.3, the server provided a multi-level history of request and connection statistics. Values for each incoming request and connection were kept individually and mapped to the chronological period they appeared in. The server then provided aggregated values for different periods, which was implemented using a constant recalculation of the aggregation values.</p>
<p>To lower ArangoDB's CPU usage, the constant recalculation has been removed in 1.3. Instead, the server will now only keep aggregate values per figure reported, but will not provide any chronological values.</p>
<p>Request and connection statistics values are 0 at server start, and will be increased with each incoming request or connection. Clients querying the statistics will see the accumulated values only. They can calculate the values for a period of time by querying the statistics twice and calculating the difference between the values themselves.</p>
<p>The REST APIs for the statistics in ArangoDB 1.3 can be found at: </p>
<pre class="fragment">/_admin/statistics
/_admin/statistics-description
</pre><p>The <code>/_admin/statistics-description</code> API can be used by clients to get descriptions for the figures reported by <code>/_admin/statistics</code>. The description will contain a textual description, the unit used for the value(s) and the boundary of slot values used.</p>
<p>The previoulsy available APIs </p>
<pre class="fragment">/_admin/request-statistics
/_admin/connection-statistics
</pre><p>are not available in ArangoDB 1.3 anymore.</p>
<h3><a class="anchor" id="NewFeatures13AQL"></a>
AQL extensions</h3>
<p>It is now possible to extend AQL with user-defined functions. These functions need to be written in Javascript, and be registered before usage in an AQL query. </p>
<pre class="fragment">arangosh&gt; var aqlfunctions = require("org/arangodb/aql/functions");
arangosh&gt; aqlfunctions.register("myfunctions:double", function (value) { return value * 2; }, true);
false
arangosh&gt; db._query("RETURN myfunctions:double(4)").toArray();
[ 8 ]
</pre><p>Please refer to <a class="el" href="ExtendingAql.html">Extending AQL with User Functions</a> for more details on this.</p>
<p>There have been the following additional changes to AQL in ArangoDB 1.3:</p>
<ul>
<li>added AQL statistical functions <code>VARIANCE_POPULATION</code>, <code>VARIANCE_SAMPLE</code>, <code>STDDEV_POPULATION</code>, <code>STDDEV_SAMPLE</code>, <code>AVERAGE</code>, <code>MEDIAN</code>. These functions work on lists.</li>
</ul>
<ul>
<li>added AQL numeric function <code>SQRT</code> to calculate square-roots.</li>
</ul>
<ul>
<li>added AQL string functions <code>TRIM</code>, <code>LEFT</code> and <code>RIGHT</code> for easier string and substring handling.</li>
</ul>
<ul>
<li>the AQL functions <code>REVERSE</code> and <code>LENGTH</code> now work on string values, too. Previously they were allowed for lists only.</li>
</ul>
<ul>
<li>made "limit" an optional parameter in the <code>NEAR</code> function. The "limit" parameter can now be either omitted completely, or set to 0. If so, an internal default value (currently 100) will be applied for the limit.</li>
</ul>
<p>Please refer to <a class="el" href="Aql.html#AqlFunctions">Functions </a> for detailed information on the AQL functions.</p>
<h3><a class="anchor" id="NewFeatures13Node"></a>
Node Modules and Packages</h3>
<p>ArangoDB 1.3 supports some of <a class="el" href="JSModules.html#JSModulesNode">modules</a> and <a class="el" href="JSModules.html#JSModulesNPM">packages</a> from node. The most important module is maybe the Buffer support, which allows to handle binary data in JavaScript. </p>
<pre class="fragment">arangosh&gt; var Buffer = require("buffer").Buffer;
arangosh&gt; a = new Buffer("414243", "hex");
ABC
arangosh&gt; a = new Buffer("414243", "ascii");
414243
arangosh&gt; a = new Buffer([48, 49, 50]);
012
</pre><p>Supplying the Buffer class makes it possible to use other interesting modules like punycode. It enables us to support some of NPM packages available - for instance CoffeeScript. </p>
<pre class="fragment">arangosh&gt; var cs = require("coffee-script");
arangosh&gt; cs.compile("a = 1");
(function() {
  var a;

  a = 1;

}).call(this);

arangosh&gt; cs.compile("square = x -&gt; x * x", { bare: true });
var square;

square = x(function() {
  return x * x;
});
</pre><p>"underscore" is also preinstalled. </p>
<pre class="fragment">arangosh&gt; var _ = require("underscore");
arangosh&gt; _.map([1,2,3], function(x) {return x*x;});
[ 
  1, 
  4, 
  9 
]
</pre><p>The node packages can be installed using npm in the "share/npm" directory. If you find out, that a node package is also working under ArangoDB, please share your findings with us and other users.</p>
<h3><a class="anchor" id="NewFeatures13Misc"></a>
Miscelleanous changes</h3>
<ul>
<li><p class="startli">Added server startup option <code>--database.force-sync-properties</code> to force syncing of collection properties on collection creation, deletion and on collection properties change.</p>
<p class="startli">The default value is <code>true</code> to mimic the behavior of previous versions of ArangoDB. If set to <code>false</code>, collection properties are still written to disk but no immediate system call to sync() is made.</p>
<p class="startli">Setting the <code>--database.force-sync-properties</code> to <code>false</code> may speed up running test suites on systems where sync() is expensive, but is discouraged for regular use cases.</p>
</li>
</ul>
<ul>
<li><p class="startli">ArangoDB will now reject saving documents with an invalid "type".</p>
<p class="startli">Previous versions of ArangoDB didn't reject documents that were just scalar values without any attribute names.</p>
<p class="startli">Starting with version 1.3, each document saved in ArangoDB must be a JSON object consisting of attribute name / attribute value pairs.</p>
<p class="startli">Storing the following types of documents will be rejected by the server: </p>
<pre class="fragment">[ "foo", "bar" ]
1.23
"test"
</pre><p class="startli">Of course such values can be stored inside valid documents, e.g. </p>
<pre class="fragment">{ "data" : [ "foo", "bar" ] }
{ "number" : 1.23 }
{ "value" : "test" }
</pre><p class="startli">User-defined document attribute names must also start with a letter or a number. It is disallowed to use user-defined attribute names starting with an underscore. This is due to name starting with an underscore being reserved for ArangoDB's internal use.</p>
</li>
</ul>
<ul>
<li><p class="startli">Changed return value of REST API method <code>/_admin/log</code>:</p>
<p class="startli">Previously, the log messages returned by the API in the <code>text</code> attribute also contained the date and log level, which was redundant.</p>
<p class="startli">In ArangoDB 1.3, the values in the <code>text</code> attribute contain only the mere log message, and no date and log level. Dates and log levels for the individual messages are still available in the separate <code>timestamp</code> and <code>level</code> attributes.</p>
</li>
</ul>
<ul>
<li><p class="startli">Extended output of server version and components for REST APIs <code>/_admin/version</code> and <code>/_api/version</code>:</p>
<p class="startli">To retrieve the extended information, the REST APIs can be called with the URL parameter <code>details=true</code>. This will provide a list of server version details in the <code>details</code> attribute of the result.</p>
</li>
</ul>
<ul>
<li><p class="startli">Extended output for REST API <code>/_api/collection/&lt;name&gt;/figures</code>:</p>
<p class="startli">The result will now contain an attribute <code>attributes</code> with a sub-attribute <code>count</code>. This value provides the number of different attributes that are or have been used in the collection. </p>
</li>
</ul>
</div></div><!-- contents -->
</div>


	  </div><!-- .entry-content -->
	</div><!-- #post-## -->


      <div id="comments">


  <p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


      </div><!-- #content -->
    </div><!-- #container -->

  <div style="clear:both;"></div>
  </div><!-- #main -->



</div><!-- #wrapper -->
</div><!-- #surrounding -->


  <div id="footer" role="contentinfo">
    <div id="colophon">




      <div id="footer-widget-area" role="complementary">

	<div id="first" class="widget-area">
	  <ul class="xoxo">
		<li id="recent-posts-4" class="widget-container widget_recent_entries">	  <h3 class="widget-title">Recent Posts</h3>	<ul>
	  <li>
	<a href="http://www.arangodb.org/2013/05/22/replication-and-sharding-in-arangodb" title="Our plans on replication and sharding in ArangoDB">Our plans on replication and sharding in ArangoDB</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/14/ideas-and-facts-from-scotland-js-in-edinburgh" title="Ideas and Facts from scotland.js in Edinburgh">Ideas and Facts from scotland.js in Edinburgh</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/12/arangodb-1-3-0-released" title="ArangoDB 1.3.0 released">ArangoDB 1.3.0 released</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/06/foxx-screencast-part-2" title="Foxx Screencast: Part 2">Foxx Screencast: Part 2</a>
	    </li>
	</ul>
    </li><li id="text-5" class="widget-container widget_text"><h3 class="widget-title">Documentation</h3>     <div class="textwidget"><ul>
  <li><a href="/quickstart">First step tutorial</a></li>
  <li><a href="/manuals">Manual/documentation (HTML/PDF)</a></li>
  <li><a href="/manuals/arangodb_1.0_shell_reference_card.pdf">ArangoDB Shell Reference Card (HTML/PDF)</a></li>
  <li><a href="/try">Try ArangoDB online</a></li>
  <li><a href="/api">API clients & 3rd party libs</a></li>
        <li><a href="/logos">ArangoDB artwork/logos</a></li>
</ul>
</div>
    </li><li id="text-7" class="widget-container widget_text"><h3 class="widget-title">Social Links</h3>      <div class="textwidget"><ul>
  <li><a href="https://twitter.com/arangodb">ArangoDB on Twitter</a></li>
  <li><a href="https://groups.google.com/group/arangodb">ArangoDB Google Group</a></li>
  <li><a href="http://stackoverflow.com/questions/tagged/arangodb">ArangoDB questions on StackOverflow</a></li>
  <li><a href="https://github.com/triagens/arangodb/issues?state=open">Issue Tracker at Github</a></li>
</ul></div>
    </li><li id="text-6" class="widget-container widget_text"><h3 class="widget-title">Roadmap</h3>	<div class="textwidget"><ul>
  <li><a href="/roadmap/#v1.4">Backlog for Version 1.4</a></li>
  <li><a href="/roadmap/#v1.x">Backlog for Version 1.x</a></li>
</ul></div>
    </li>	  </ul>
	</div><!-- #first .widget-area -->




      </div><!-- #footer-widget-area -->


<!-- #site-generator -->

    </div><!-- #colophon -->

        <div class="copy">
            Copyright 2013 ArangoDB | <a href="/imprint">Imprint</a>
        </div>

  </div><!-- #footer -->

</body>
</html>