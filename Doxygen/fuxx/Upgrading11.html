<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />


<link rel="shortcut icon" type="image/x-icon" href="http://www.arangodb.org/wp-content/themes/triagens/images/favicon.ico">

<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="http://www.arangodb.org/wp-content/themes/triagens-child/style.css" />
<link rel="pingback" href="" />


<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.4 - http://yoast.com/wordpress/seo/ -->
<title>ArangoDB Manual Pages - ArangoDB</title>
<meta name="description" content="ArangoDB Manual Pages"/>
<link rel="canonical" href="http://www.arangodb.org/manualredirector" />
<meta property='og:locale' content='en_US'/>
<meta property='og:title' content='ArangoDB Manual Pages - ArangoDB'/>
<meta property='og:description' content='ArangoDB Manual Pages'/>
<meta property='og:url' content='http://www.arangodb.org/manualredirector'/>
<meta property='og:site_name' content='ArangoDB'/>
<meta property='og:type' content='article'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Feed" href="http://www.arangodb.org/feed" />
<link rel="alternate" type="application/rss+xml" title="ArangoDB &raquo; Comments Feed" href="http://www.arangodb.org/comments/feed" />
<link rel='stylesheet' id='wordpress-popular-posts-css'  href='http://www.arangodb.org/wp-content/plugins/wordpress-popular-posts/style/wpp.css?ver=3.5.1' type='text/css' media='all' />
<link rel='stylesheet' id='wp-syntax-css-css'  href='http://www.arangodb.org/wp-content/plugins/wp-syntax/css/wp-syntax.css?ver=1.0' type='text/css' media='all' />
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/jquery/jquery.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://www.arangodb.org/wp-includes/js/comment-reply.min.js?ver=3.5.1'></script>

    <style type="text/css">
    body {
    margin-top: -28px;
    padding-bottom: 28px;
    }
    body.admin-bar #wphead {
       padding-top: 0;
    }
    body.admin-bar #footer {
       padding-bottom: 28px;
    }
<link type="text/css" media="screen" rel="stylesheet" href="http://www.arangodb.org/wp-content/plugins/tweet-blender/css/tweets.css" />

    <style media="print" type="text/css">
      div.faq_answer {display: block!important;}
      p.faq_nav {display: none;}
    </style>


</head>

<body class="page page-id-1410 page-template page-template-onecolumn-page-php">

    <div id="access" role="navigation">
        <div id="nav">
            <a href="http://www.arangodb.org/" title="ArangoDB" id="branding"><img src="/wp-content/themes/triagens/images/logo_arangob_white.gif" width="154" height="34" alt="ArangoDB"></a>
            <div class="menu-header"><ul id="menu-home" class="menu"><li id="menu-item-184" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-184"><a href="http://www.arangodb.org/">Home</a></li>
<li id="menu-item-1345" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1345"><a href="http://www.arangodb.org/try">Try it out</a></li>
<li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://www.arangodb.org/documentation">Documentation</a></li>
<li id="menu-item-95" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-95"><a href="http://www.arangodb.org/roadmap">Roadmap</a></li>
<li id="menu-item-71" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-71"><a href="http://www.arangodb.org/download">Downloads</a></li>
<li id="menu-item-1299" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1299"><a href="http://www.arangodb.org/api">Drivers</a></li>
<li id="menu-item-156" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-156"><a href="http://www.arangodb.org/blog">Blog</a></li>
</ul></div>            <div class="clear_both"></div>
        </div>
    </div><!-- #access -->

  <div id="surrounding">

    <div id="wrapper" class="hfeed">
	<div id="main">

    <div id="fullsize" class="one-column">
      <div id="content" role="main">



            <div id="post-1410" class="post-1410 page type-page status-publish hentry">
                    <h2 class="entry-title">ArangoDB Manual Pages</h2>

	  <div class="entry-content">

<link id="arangodb.css" type="text/css" href="arangodb.css" rel="stylesheet">
</div>
<div id="manual_search">
<form action="/" id="searchform" method="get" role="search">
  <div><label for="s" class="screen-reader-text">Search for:</label>
    <input type="text" id="s" name="s" value="" />
    <input type="submit" value="Search" id="searchsubmit" />
  </div>
</form>
</div>
<div class="clear_both"></div>
<hr />
<div class="arangodb">
<div>
<!-- Generated by Doxygen 1.8.2 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Upgrading to ArangoDB 1.1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> <div class="navigate"><a href="NewFeatures11.html">prev</a> | <a href="Home.html">home</a> | next</div>  <div class="toc"><ul>
<li><a class="el" href="Upgrading11.html#Upgrading11Introduction">Upgrading </a><ul>
<li><a class="el" href="Upgrading11.html#Upgrading11NewDependencies">New Dependencies </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11VersionCheck">Database Directory Version Check and Upgrade </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11ServerOptions">Server Startup Options Changes </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11StartScripts">Start / Stop Scripts </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11CollectionTypes">Collection Types </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11ShellImport">arangoimp / arangosh </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11Syslog">Change of Syslog Usage </a></li>
</ul>
</li>
<li><a class="el" href="Upgrading11.html#Upgrading11Troubleshooting">Troubleshooting </a></li>
<li><a class="el" href="Upgrading11.html#Upgrading11RemovedFeatures">Removed Features </a><ul>
<li><a class="el" href="Upgrading11.html#Upgrading11RemovedDependencies">Removed Dependencies </a> </li>
</ul>
</li>
</ul>
  </div> <h2><a class="anchor" id="Upgrading11Introduction"></a>
Upgrading </h2>
<p>ArangoDB 1.1 introduces new features but may in some respect have slightly different behavior than in 1.0.</p>
<p>This is unavoidable as new features get introduced and others become superfluous.</p>
<p>The following list contains changes in ArangoDB 1.1 that are not 100% downwards-compatible to ArangoDB 1.0.</p>
<p>Existing users of ArangoDB 1.0 should read the list carefully and make sure they have undertaken all necessary steps and precautions before upgrading from ArangoDB 1.0 to ArangoDB 1.1. Also check <a class="el" href="Upgrading11.html#Upgrading11Troubleshooting">Troubleshooting </a>.</p>
<h3><a class="anchor" id="Upgrading11NewDependencies"></a>
New Dependencies </h3>
<p>As ArangoDB 1.1 supports SSL connections, ArangoDB can only be built on servers with the OpenSSL library installed. The OpenSSL is not bundled with ArangoDB and must be installed separately.</p>
<h3><a class="anchor" id="Upgrading11VersionCheck"></a>
Database Directory Version Check and Upgrade </h3>
<p>Starting with ArangoDB 1.1, <em>arangod</em> will perform a database version check at startup.</p>
<p>It will look for a file named <em>VERSION</em> in its database directory. If the file is not present (it will not be present in an ArangoDB 1.0 database), <em>arangod</em> in version 1.1 will perform an auto-upgrade. This auto-upgrade will create the system collections necessary to run ArangoDB 1.1, and it will also create the VERSION file.</p>
<p>If the <em>VERSION</em> file is present but is from a non-matching version of ArangoDB, <em>arangod</em> will also refuse to start and ask the user to start the server with the option <code>--upgrade</code>.</p>
<p>This procedure shall ensure that users in the future will have full control over when they perform any updates/upgrades of their data, and do not risk running an incompatible tandem of server and database.</p>
<p>ArangoDB users are asked to start the server with the <code>--upgrade</code> option when upgrading from one version of ArangoDB to a higher version (e.g. from 1.0 to 1.1 in this case), but also after pulling the latest ArangoDB source code while staying in the same minor version (e.g. when updating from 1.1-beta1 to 1.1-beta2).</p>
<p>The upgrade procedure is started when the server is started with the additional command line option <code>--upgrade</code> as follows: </p>
<pre class="fragment">&gt; bin/arangod --server.endpoint tcp://127.0.0.1:8529 --database.directory /tmp/voctest --upgrade

...
2012-12-03T11:22:08Z [11573] INFO Starting upgrade from version 1.0 to 1.1.beta2
2012-12-03T11:22:08Z [11573] INFO Found 9 defined task(s), 9 task(s) to run
...
2012-12-03T11:22:08Z [11573] INFO Upgrade successfully finished
</pre><p>The upgrade procecure will execute the defined tasks to run <em>arangod</em> with all new features and data formats. It should normally run without problems and indicate success at script end. If it detects a problem that it cannot fix, it will halt on the first error and warn the user.</p>
<p>Re-starting arangod with the <code>--upgrade</code> option will execute only the previously failed and not yet executed tasks.</p>
<h3><a class="anchor" id="Upgrading11ServerOptions"></a>
Server Startup Options Changes </h3>
<h4>Port options and endpoints</h4>
<p>The following startup options have been removed for <em>arangod</em> in version 1.1:</p>
<ul>
<li><code>--port</code></li>
<li><code>--server.port</code></li>
<li><code>--server.http-port</code></li>
<li><code>--server.admin-port</code></li>
</ul>
<p>All these options are replaced by the new <code>--server.endpoint</code> option in ArangoDB 1.1.</p>
<p>The server must now be started with a defined endpoint. The new <code>--server.endpoint</code> option is required to specify the protocol, hostname and port the server should use when listening for incoming connections.</p>
<p>The <code>--server.endpoint</code> option must be specified on server start, either on the command line or via a configuration file, otherwise <em>arangod</em> will refuse to start.</p>
<p>The server can be bound to one or multiple endpoints at once. The following endpoint specification sytnax is currently supported:</p>
<ul>
<li><code>tcp://host:port</code> (HTTP over IPv4)</li>
<li><code>tcp://[host]:port</code> (HTTP over IPv6)</li>
<li><code>ssl://host:port</code> (HTTP over SSL-encrypted IPv4)</li>
<li><code>ssl://[host]:port</code> (HTTP over SSL-encrypted IPv6)</li>
<li><code>unix:///path/to/socket</code> (HTTP over UNIX socket)</li>
</ul>
<p>An example value for the option is <code>--server.endpoint tcp://127.0.0.1:8529</code>. This will make the server listen to requests coming in on IP address 127.0.0.1 on port 8529, and that use HTTP over TCP/IPv4.</p>
<h4>Authorization</h4>
<p>Starting from 1.1, <em>arangod</em> may be started with authentication turned on. When authentication is turned on, all requests incoming to <em>arangod</em> via the HTTP interface must carry an <em>HTTP authorization</em> header with a valid username and password in order to be processed. Clients sending requests without HTTP autorization headers or with invalid usernames/passwords will be rejected by arangod with an HTTP 401 error.</p>
<p>The upgrade procedure for ArangoDB 1.1 will create a default user <em>root</em> with an empty password when run initially.</p>
<p>To turn authorization off, the server can be started with the following command line option: </p>
<pre class="fragment">--server.disable-authentication true
</pre><p>Of course this option can also be stored in a configuration file.</p>
<h4>HTTP keep-alive</h4>
<p>The following <em>arangod</em> startup options have been removed in ArangoDB 1.1:</p>
<ul>
<li><code>--server.require-keep-alive</code></li>
<li><code>--server.secure-require-keep-alive</code></li>
</ul>
<p>In version 1.1, the server will behave as follows automatically which should be more conforming to the HTTP standard:</p>
<ul>
<li>if a client sends a <code>Connection: close</code> HTTP header, the server will close the connection as requested</li>
<li>if a client sends a <code>Connection: keep-alive</code> HTTP header, the server will not close the connection but keep it alive as requested</li>
<li>if a client does not send any <code>Connection</code> HTTP header, the server will assume <em>keep-alive</em> if the request was an HTTP/1.1 request, and <em>close</em> if the request was an HTTP/1.0 request</li>
<li>dangling keep-alive connections will be closed automatically by the server after a configurable amount of seconds. To adjust the value, use the new server option <code>--server.keep-alive-timeout</code>.</li>
<li>Keep-alive can be turned off in ArangoDB by setting <code>--server.keep-alive-timeout</code> to a value of <code>0</code>.</li>
</ul>
<p>As ArangoDB 1.1 will use keep-alive by default for incoming HTTP/1.1 requests without a <code>Connection</code> header, using ArangoDB 1.1 from a browser will likely result in the same connection being re-used. This may be unintuitive because requests from a browser to ArangoDB will effectively be serialised, not parallelised. To conduct parallel requests from a browser, you should either set <code>--server.keep-alive-timeout</code> to a value of <code>0</code>, or make your browser send <code>Connection: close</code> HTTP headers with its requests.</p>
<h3><a class="anchor" id="Upgrading11StartScripts"></a>
Start / Stop Scripts </h3>
<p>The user used in start and stop scripts has changed from <em>arango</em> to <em>arangodb</em>. Furthermore, the start script name itself has changed from <em>arangod</em> to <em>arangodb</em>. Additionally, the default database directory name changed from _/var/arangodb_ to _/var/lib/arangodb_. This was necessary to be more compliant with various Linux policies.</p>
<h3><a class="anchor" id="Upgrading11CollectionTypes"></a>
Collection Types </h3>
<p>In ArangoDB 1.1, collection types have been introduced:</p>
<ul>
<li>regular documents go into <em>document</em>-only collections,</li>
<li>and edges go into <em>edge</em> collections.</li>
</ul>
<p>The prefixing (<code>db.xxx</code> and <code>edges.xxx</code>) that could be used to access a collection thus works slightly differently in 1.1:</p>
<p><code>edges.xxx</code> can still be used to access collections, however, it will not determine the type of existing collections anymore. In 1.0, you could write <code>edges.xxx.something</code> and <code>xxx</code> was automatically treated as an <em>edge</em> collection.</p>
<p>As collections know and save their type in ArangoDB 1.1, this might work slightly differently. The type of existing collections is immutable and not modifiable by changing the prefix (<code>db</code> or <code>edges</code>).</p>
<p>In 1.1, <em>edge</em> collections can be created via the following ways:</p>
<ul>
<li><code>edges._create()</code> as in 1.0</li>
<li>addtionally there is a new method <code>db._createEdgeCollection()</code></li>
</ul>
<p>To create <em>document</em> collections, the following methods are available:</p>
<ul>
<li><code>db._create()</code> as in 1.0,</li>
<li>additionally there is now <code>db._createDocumentCollection()</code></li>
</ul>
<p>Collections in 1.1 are now either <em>document</em>-only or <em>edge</em> collections, but the two concepts cannot be mixed in the same collection.</p>
<p>The upgrade procedure for ArangoDB 1.1 will determine the types of existing collections from 1.0 once, based on the inspection of the first 50 documents in the collection.</p>
<p>If one of the documents contains either a <code>_from</code> or a <code>_to</code> attribute, the collection is made an <em>edge</em> collection. Otherwise, the collection is marked as a <em>document</em> collection.</p>
<p>This distinction is important because edges can only be created in <em>edge</em> collections starting with 1.1. User code may need to be adjusted to work with ArangoDB 1.1 if it tries to insert edges into <em>document</em>-only collections.</p>
<p>User code must also be adjusted if it uses the <code>ArangoEdges</code> or <code>ArangoEdgesCollection</code> objects that were present in ArangoDB 1.0 on the server. This only affects user code that was intended to be run on the server, directly in ArangoDB. The <code>ArangoEdges</code> or <code>ArangoEdgesCollection</code> objects were not exposed to <em>arangosh</em> or any other clients.</p>
<h3><a class="anchor" id="Upgrading11ShellImport"></a>
arangoimp / arangosh </h3>
<p>The parameters <code>--connect-timeout</code> and <code>--request-timeout</code> for <em>arangosh</em> and <em>arangoimp</em> have been renamed to <code>--server.connect-timeout</code> and <code>--server.request-timeout</code>.</p>
<p>The parameter <code>--server</code> has been removed for both <em>arangoimp</em> and <em>arangosh</em>.</p>
<p>To specify a server to connect to, the client tools now provide an option <code>--server.endpoint</code>. This option can be used to specify the protocol, hostname and port for the connection. The default endpoint that is used when none is specified is <code>tcp://127.0.0.1:8529</code>. For more information on the endpoint specification syntax, see above.</p>
<p>The options <code>--server.username</code> and <code>--server.password</code> have been added for <em>arangoimp</em> and <em>arangosh</em> in order to use authorization from these client tools, too.</p>
<p>These options can be used to specify the username and password when connecting via client tools to the <em>arangod</em> server. If no password is given on the command line, <em>arangoimp</em> and <em>arangosh</em> will interactively prompt for a password. If no username is specified on the command line, the default user <em>root</em> will be used but there will still be a password prompt.</p>
<h3><a class="anchor" id="Upgrading11Syslog"></a>
Change of Syslog Usage </h3>
<p>In 1.0, arangod always logged its output to the syslog, regardless of any other logging that was configured. In 1.1, this has changed. Log messages will be sent to the syslog only if the server is started with the <code>--log.syslog</code> option and a non-empty string (the log facility) is given to it. This is in accordance with the 1.0 documentation.</p>
<h2><a class="anchor" id="Upgrading11Troubleshooting"></a>
Troubleshooting </h2>
<p>If you cannot find a solution here, please ask the Google-Group at <a href="http://groups.google.com/group/arangodb">http://groups.google.com/group/arangodb</a></p>
<h3>Problem: ArangoDB does not start after upgrade</h3>
<ul>
<li>Check the logfile <code>/var/log/arangodb/arangod.log</code></li>
</ul>
<ul>
<li><p class="startli">Check the permissions of these directories:</p>
<ul>
<li><code>/var/lib/arangodb/</code></li>
<li><code>/var/run/arangodb/</code></li>
<li><code>/var/log/arangodb/</code></li>
</ul>
<p class="startli">These directories and all files have to be readable and writable for the user "arangodb" and group "arangodb" (not for MacOSX). Double check that the user is "arangodb" not "arango".</p>
<p class="startli">Change the permissions using: </p>
<pre class="fragment">unix&gt; chown -R arangodb:arangodb /var/lib/arangodb/ /var/run/arangodb/ /var/log/arangodb/
</pre></li>
</ul>
<ul>
<li>Check the configuration file in: <pre class="fragment">/etc/arangodb/arangod.conf
</pre></li>
</ul>
<h3>Problem: Packet manager finds no upgrade</h3>
<ul>
<li><p class="startli">Check the name of the repository here:</p>
<p class="startli"><a href="http://www.arangodb.org/download">http://www.arangodb.org/download</a></p>
</li>
</ul>
<h3>Problem: Database is empty</h3>
<p>Check that the database file </p>
<pre class="fragment">/var/lib/arangodb
</pre><p>contains your collections. If it is empty, check the old location of the database at </p>
<pre class="fragment">/var/arangodb
</pre><p>If necessary, stop the server, copy the files using </p>
<pre class="fragment">cp /var/arangodb/* /var/lib/arangodb
</pre><p>and start the server agaib.</p>
<h2><a class="anchor" id="Upgrading11RemovedFeatures"></a>
Removed Features </h2>
<h3><a class="anchor" id="Upgrading11RemovedDependencies"></a>
Removed Dependencies </h3>
<p>ArangoDB no longer requires BOOST, ZeroMQ, or ProtocolBuffers.</p>
<h3><a class="anchor" id="Upgrading11RemovedFunctionality"></a>
Removed Functionality </h3>
<h4>Configuration</h4>
<p>In 1.0, there were unfinished REST APIs available at the <code>/_admin/config</code> URL suffix. These APIs were stubs only and have been removed in ArangoDB 1.1.</p>
<h4>Front-End User and Session Management</h4>
<p>In 1.0, there was an API to manage user and session for the GUI administraion interface. In 1.1 the user management is part of the database (not just the front-end). There the calls to <code>_admin/user-manager</code> where removed. </p>
</div></div><!-- contents -->
</div>


	  </div><!-- .entry-content -->
	</div><!-- #post-## -->


      <div id="comments">


  <p class="nocomments">Comments are closed.</p>



</div><!-- #comments -->


      </div><!-- #content -->
    </div><!-- #container -->

  <div style="clear:both;"></div>
  </div><!-- #main -->



</div><!-- #wrapper -->
</div><!-- #surrounding -->


  <div id="footer" role="contentinfo">
    <div id="colophon">




      <div id="footer-widget-area" role="complementary">

	<div id="first" class="widget-area">
	  <ul class="xoxo">
		<li id="recent-posts-4" class="widget-container widget_recent_entries">	  <h3 class="widget-title">Recent Posts</h3>	<ul>
	  <li>
	<a href="http://www.arangodb.org/2013/05/22/replication-and-sharding-in-arangodb" title="Our plans on replication and sharding in ArangoDB">Our plans on replication and sharding in ArangoDB</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/14/ideas-and-facts-from-scotland-js-in-edinburgh" title="Ideas and Facts from scotland.js in Edinburgh">Ideas and Facts from scotland.js in Edinburgh</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/12/arangodb-1-3-0-released" title="ArangoDB 1.3.0 released">ArangoDB 1.3.0 released</a>
	    </li>
	  <li>
	<a href="http://www.arangodb.org/2013/05/06/foxx-screencast-part-2" title="Foxx Screencast: Part 2">Foxx Screencast: Part 2</a>
	    </li>
	</ul>
    </li><li id="text-5" class="widget-container widget_text"><h3 class="widget-title">Documentation</h3>     <div class="textwidget"><ul>
  <li><a href="/quickstart">First step tutorial</a></li>
  <li><a href="/manuals">Manual/documentation (HTML/PDF)</a></li>
  <li><a href="/manuals/arangodb_1.0_shell_reference_card.pdf">ArangoDB Shell Reference Card (HTML/PDF)</a></li>
  <li><a href="/try">Try ArangoDB online</a></li>
  <li><a href="/api">API clients & 3rd party libs</a></li>
        <li><a href="/logos">ArangoDB artwork/logos</a></li>
</ul>
</div>
    </li><li id="text-7" class="widget-container widget_text"><h3 class="widget-title">Social Links</h3>      <div class="textwidget"><ul>
  <li><a href="https://twitter.com/arangodb">ArangoDB on Twitter</a></li>
  <li><a href="https://groups.google.com/group/arangodb">ArangoDB Google Group</a></li>
  <li><a href="http://stackoverflow.com/questions/tagged/arangodb">ArangoDB questions on StackOverflow</a></li>
  <li><a href="https://github.com/triagens/arangodb/issues?state=open">Issue Tracker at Github</a></li>
</ul></div>
    </li><li id="text-6" class="widget-container widget_text"><h3 class="widget-title">Roadmap</h3>	<div class="textwidget"><ul>
  <li><a href="/roadmap/#v1.4">Backlog for Version 1.4</a></li>
  <li><a href="/roadmap/#v1.x">Backlog for Version 1.x</a></li>
</ul></div>
    </li>	  </ul>
	</div><!-- #first .widget-area -->




      </div><!-- #footer-widget-area -->


<!-- #site-generator -->

    </div><!-- #colophon -->

        <div class="copy">
            Copyright 2013 ArangoDB | <a href="/imprint">Imprint</a>
        </div>

  </div><!-- #footer -->

</body>
</html>